cpu-bind=MASK - n2gpu1225, task  0  0 [413532]: mask |--------|--------||--------|--------||--------|--------||--------|--------||||--------|--------||--------|--------||-B------|--------||--------|--------|  set
Total estimated parameters in the Dense GPT-2 model: 760300032 (0.76B)
Total Estimated Parameters in the Sparse(MoE) GPT-2 model: 29763125760 (29.76B)
LAUNCHER: python -u -m torch.distributed.run --nproc_per_node 1 --nnodes 1 --rdzv_id=5215 --rdzv_endpoint n2gpu1225:6031 --rdzv_backend c10d --max_restarts 0 --tee 3
CMD: /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py --override-opt_param-scheduler --adam-beta1 0.9 --adam-beta2 0.95 --tensor-model-parallel-size 1 --moe-expert-parallel-size 1 --num-experts 128 --moe-loss-coeff 0.01 --moe-train-capacity-factor 1.0 --moe-eval-capacity-factor 1.0 --moe-min-capacity 4 --init-method-std 0.01 --lr-decay-tokens 300000000000 --lr-warmup-tokens 375000000 --micro-batch-size 4 --exit-duration-in-mins 30000000 --global-batch-size 4 --num-layers 24 --hidden-size 1536 --num-attention-heads 16 --seq-length 2048 --max-position-embeddings 2048 --train-tokens 300000000000 --train-iters 109863281 --lr 2.0e-4 --min-lr 2e-06 --lr-decay-style cosine --split 98,2,0 --log-interval 5 --eval-interval 100 --eval-iters 50 --save-interval 1000000 --weight-decay 0.1 --clip-grad 1.0 --hysteresis 2 --num-workers 0 --fp16 --load /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/checkpoint/gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true --save /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/checkpoint/gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true --tensorboard-queue-size 1 --log-timers-to-tensorboard --log-batch-size-to-tensorboard --log-validation-ppl-to-tensorboard --tensorboard-dir /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/tensorboard/gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true_n2gpu1225_2023.07.30-22.21.45 --checkpoint-activations --create-moe-param-group --vocab-file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/gpt2-vocab.json --merge-file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/gpt2-merges.txt --data-path /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/meg-gpt2-oscar-en-10k_text_document --data-impl mmap --deepspeed --deepspeed_config /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/ds_config_gpt_gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true.json --pipeline-model-parallel-size 1 --no-pipeline-parallel --deepspeed-activation-checkpointing
cpu-bind=MASK - n2gpu1225, task  0  0 [413769]: mask |--------|--------||--------|--------||--------|--------||--------|--------||||--------|--------||--------|--------||-B------|--------||--------|--------|  set
[default0]:[2023-07-30 22:21:48,029] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default0]:--------------------------------------------------
[default0]:DeepSpeed C++/CUDA extension op report
[default0]:--------------------------------------------------
[default0]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default0]:      runtime if needed. Op compatibility means that your system
[default0]:      meet the required dependencies to JIT install the op.
[default0]:--------------------------------------------------
[default0]:JIT compiled ops requires ninja
[default0]:ninja .................. [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:op name ................ installed .. compatible
[default0]:--------------------------------------------------
[default0]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default0]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default0]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default0]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default0]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default0]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default0]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:DeepSpeed general environment info:
[default0]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default0]:torch version .................... 1.12.0
[default0]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default0]:deepspeed info ................... 0.10.0, unknown, unknown
[default0]:torch cuda version ............... 11.7
[default0]:torch hip version ................ None
[default0]:nvcc version ..................... 11.7
[default0]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default0]:**** Git info for Megatron: git_hash=6e47d55 git_branch=main ****
[default0]:using world size: 1, data-parallel-size: 1, tensor-model-parallel size: 1, pipeline-model-parallel size: 1 
[default0]:using torch.float16 for parameters ...
[default0]:------------------------ arguments ------------------------
[default0]:  accumulate_allreduce_grads_in_fp32 .............. False
[default0]:  adam_beta1 ...................................... 0.9
[default0]:  adam_beta2 ...................................... 0.95
[default0]:  adam_eps ........................................ 1e-08
[default0]:  add_bias_linear ................................. True
[default0]:  add_position_embedding .......................... True
[default0]:  adlr_autoresume ................................. False
[default0]:  adlr_autoresume_interval ........................ 1000
[default0]:  aml_data_download_path .......................... None
[default0]:  apply_layernorm_1p .............................. False
[default0]:  apply_query_key_layer_scaling ................... True
[default0]:  apply_residual_connection_post_layernorm ........ False
[default0]:  async_tensor_model_parallel_allreduce ........... False
[default0]:  attention_dropout ............................... 0.1
[default0]:  attention_softmax_in_fp32 ....................... False
[default0]:  barrier_with_L1_time ............................ True
[default0]:  bert_binary_head ................................ True
[default0]:  bert_embedder_type .............................. megatron
[default0]:  bert_load ....................................... None
[default0]:  bf16 ............................................ False
[default0]:  bias_dropout_fusion ............................. True
[default0]:  bias_gelu_fusion ................................ True
[default0]:  biencoder_projection_dim ........................ 0
[default0]:  biencoder_shared_query_context_model ............ False
[default0]:  block_data_path ................................. None
[default0]:  checkpoint_activations .......................... True
[default0]:  checkpoint_in_cpu ............................... False
[default0]:  checkpoint_num_layers ........................... 1
[default0]:  classes_fraction ................................ 1.0
[default0]:  clip_grad ....................................... 1.0
[default0]:  compression_training ............................ False
[default0]:  consumed_train_samples .......................... 0
[default0]:  consumed_train_tokens ........................... 0
[default0]:  consumed_valid_samples .......................... 0
[default0]:  contigious_checkpointing ........................ False
[default0]:  cpu_optimizer ................................... False
[default0]:  cpu_torch_adam .................................. False
[default0]:  create_moe_param_group .......................... True
[default0]:  curriculum_learning_legacy ...................... False
[default0]:  data_cache_path ................................. None
[default0]:  data_efficiency_curriculum_learning ............. False
[default0]:  data_impl ....................................... mmap
[default0]:  data_parallel_random_init ....................... False
[default0]:  data_parallel_size .............................. 1
[default0]:  data_path ....................................... ['/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/meg-gpt2-oscar-en-10k_text_document']
[default0]:  data_per_class_fraction ......................... 1.0
[default0]:  data_sharding ................................... True
[default0]:  dataloader_type ................................. single
[default0]:  DDP_impl ........................................ local
[default0]:  decoder_num_layers .............................. None
[default0]:  decoder_seq_length .............................. None
[default0]:  deepscale ....................................... False
[default0]:  deepscale_config ................................ None
[default0]:  deepspeed ....................................... True
[default0]:  deepspeed_activation_checkpointing .............. True
[default0]:  deepspeed_config ................................ /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/ds_config_gpt_gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true.json
[default0]:  deepspeed_mpi ................................... False
[default0]:  dino_bottleneck_size ............................ 256
[default0]:  dino_freeze_last_layer .......................... 1
[default0]:  dino_head_hidden_size ........................... 2048
[default0]:  dino_local_crops_number ......................... 10
[default0]:  dino_local_img_size ............................. 96
[default0]:  dino_norm_last_layer ............................ False
[default0]:  dino_teacher_temp ............................... 0.07
[default0]:  dino_warmup_teacher_temp ........................ 0.04
[default0]:  dino_warmup_teacher_temp_epochs ................. 30
[default0]:  distribute_checkpointed_activations ............. False
[default0]:  distribute_saved_activations .................... False
[default0]:  distributed_backend ............................. nccl
[default0]:  distributed_timeout_minutes ..................... 10
[default0]:  ds_inference .................................... False
[default0]:  ds_pipeline_enabled ............................. False
[default0]:  embedding_path .................................. None
[default0]:  embedding_weights_in_fp32 ....................... False
[default0]:  empty_unused_memory_level ....................... 0
[default0]:  enable_expert_tensor_parallelism ................ False
[default0]:  encoder_num_layers .............................. 24
[default0]:  encoder_seq_length .............................. 2048
[default0]:  end_weight_decay ................................ 0.1
[default0]:  eod_mask_loss ................................... False
[default0]:  eval_interval ................................... 100
[default0]:  eval_iters ...................................... 50
[default0]:  evidence_data_path .............................. None
[default0]:  exit_duration_in_mins ........................... 30000000
[default0]:  exit_interval ................................... None
[default0]:  exit_on_missing_checkpoint ...................... False
[default0]:  exit_signal_handler ............................. False
[default0]:  expert_interval ................................. 2
[default0]:  ffn_hidden_size ................................. 6144
[default0]:  finetune ........................................ False
[default0]:  fp16 ............................................ True
[default0]:  fp16_lm_cross_entropy ........................... False
[default0]:  fp32_residual_connection ........................ False
[default0]:  fp8_amax_compute_algo ........................... most_recent
[default0]:  fp8_amax_history_len ............................ 1
[default0]:  fp8_e4m3 ........................................ False
[default0]:  fp8_hybrid ...................................... False
[default0]:  fp8_interval .................................... 1
[default0]:  fp8_margin ...................................... 0
[default0]:  fp8_wgrad ....................................... True
[default0]:  global_batch_size ............................... 4
[default0]:  gradient_accumulation_fusion .................... True
[default0]:  head_lr_mult .................................... 1.0
[default0]:  hidden_dropout .................................. 0.1
[default0]:  hidden_size ..................................... 1536
[default0]:  hidden_size_teacher ............................. None
[default0]:  hysteresis ...................................... 2
[default0]:  ict_head_size ................................... None
[default0]:  ict_load ........................................ None
[default0]:  img_h ........................................... 224
[default0]:  img_w ........................................... 224
[default0]:  indexer_batch_size .............................. 128
[default0]:  indexer_log_interval ............................ 1000
[default0]:  inference ....................................... False
[default0]:  inference_batch_times_seqlen_threshold .......... 512
[default0]:  init_method_std ................................. 0.01
[default0]:  init_method_xavier_uniform ...................... False
[default0]:  initial_loss_scale .............................. 4294967296
[default0]:  iter_per_epoch .................................. 1250
[default0]:  kd .............................................. False
[default0]:  kd_alpha_ce ..................................... 1
[default0]:  kd_beta_ce ...................................... 1
[default0]:  kd_temp ......................................... 1.0
[default0]:  kv_channels ..................................... 96
[default0]:  layernorm_epsilon ............................... 1e-05
[default0]:  lazy_mpu_init ................................... None
[default0]:  load ............................................ /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/checkpoint/gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true
[default0]:  load_teacher .................................... None
[default0]:  local_rank ...................................... None
[default0]:  log_batch_size_to_tensorboard ................... True
[default0]:  log_interval .................................... 5
[default0]:  log_learning_rate_to_tensorboard ................ True
[default0]:  log_loss_scale_to_tensorboard ................... True
[default0]:  log_memory_to_tensorboard ....................... False
[default0]:  log_num_zeros_in_grad ........................... False
[default0]:  log_optimizer_states_to_tensorboard ............. False
[default0]:  log_params_norm ................................. False
[default0]:  log_timers_to_tensorboard ....................... True
[default0]:  log_validation_ppl_to_tensorboard ............... True
[default0]:  log_world_size_to_tensorboard ................... False
[default0]:  loss_scale ...................................... None
[default0]:  loss_scale_window ............................... 1000
[default0]:  lr .............................................. 0.0002
[default0]:  lr_decay_iters .................................. None
[default0]:  lr_decay_samples ................................ None
[default0]:  lr_decay_style .................................. cosine
[default0]:  lr_decay_tokens ................................. 300000000000
[default0]:  lr_warmup_fraction .............................. None
[default0]:  lr_warmup_iters ................................. 0
[default0]:  lr_warmup_samples ............................... 0
[default0]:  lr_warmup_tokens ................................ 375000000
[default0]:  make_vocab_size_divisible_by .................... 128
[default0]:  mask_factor ..................................... 1.0
[default0]:  mask_prob ....................................... 0.15
[default0]:  mask_type ....................................... random
[default0]:  masked_softmax_fusion ........................... True
[default0]:  max_position_embeddings ......................... 2048
[default0]:  max_tokens_to_oom ............................... 12000
[default0]:  memory_centric_tiled_linear ..................... False
[default0]:  merge_file ...................................... /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/gpt2-merges.txt
[default0]:  micro_batch_size ................................ 4
[default0]:  min_loss_scale .................................. 1.0
[default0]:  min_lr .......................................... 2e-06
[default0]:  mlp_type ........................................ standard
[default0]:  mmap_warmup ..................................... False
[default0]:  moe_eval_capacity_factor ........................ 1.0
[default0]:  moe_expert_parallel_size ........................ 1
[default0]:  moe_loss_coeff .................................. 0.01
[default0]:  moe_min_capacity ................................ 4
[default0]:  moe_token_dropping .............................. True
[default0]:  moe_train_capacity_factor ....................... 1.0
[default0]:  mos ............................................. False
[default0]:  no_load_lr_state ................................ False
[default0]:  no_load_optim ................................... None
[default0]:  no_load_rng ..................................... None
[default0]:  no_persist_layer_norm ........................... False
[default0]:  no_pipeline_parallel ............................ True
[default0]:  no_save_optim ................................... None
[default0]:  no_save_rng ..................................... None
[default0]:  normalization ................................... layernorm
[default0]:  num_attention_heads ............................. 16
[default0]:  num_attention_heads_teacher ..................... None
[default0]:  num_channels .................................... 3
[default0]:  num_classes ..................................... 1000
[default0]:  num_experts ..................................... [128]
[default0]:  num_experts_switch .............................. None
[default0]:  num_experts_teacher ............................. [1]
[default0]:  num_layers ...................................... 24
[default0]:  num_layers_per_virtual_pipeline_stage ........... None
[default0]:  num_layers_teacher .............................. None
[default0]:  num_workers ..................................... 0
[default0]:  onnx_safe ....................................... None
[default0]:  openai_gelu ..................................... False
[default0]:  optimizer ....................................... adam
[default0]:  output_bert_embeddings .......................... False
[default0]:  overlap_p2p_comm ................................ False
[default0]:  override_opt_param_scheduler .................... True
[default0]:  params_dtype .................................... torch.float16
[default0]:  partition_activations ........................... False
[default0]:  patch_dim ....................................... 16
[default0]:  perform_initialization .......................... True
[default0]:  pipeline_model_parallel_size .................... 1
[default0]:  pipeline_model_parallel_split_rank .............. None
[default0]:  profile_backward ................................ False
[default0]:  query_in_block_prob ............................. 0.1
[default0]:  rampup_batch_size ............................... None
[default0]:  random_ltd ...................................... False
[default0]:  rank ............................................ 0
[default0]:  recompute_granularity ........................... None
[default0]:  recompute_method ................................ None
[default0]:  recompute_num_layers ............................ 1
[default0]:  remote_device ................................... none
[default0]:  reset_attention_mask ............................ False
[default0]:  reset_iteration ................................. False
[default0]:  reset_position_ids .............................. False
[default0]:  retriever_report_topk_accuracies ................ []
[default0]:  retriever_score_scaling ......................... False
[default0]:  retriever_seq_length ............................ 256
[default0]:  retro_add_retriever ............................. False
[default0]:  retro_cyclic_train_iters ........................ None
[default0]:  retro_encoder_attention_dropout ................. 0.1
[default0]:  retro_encoder_hidden_dropout .................... 0.1
[default0]:  retro_encoder_layers ............................ 2
[default0]:  retro_num_neighbors ............................. 2
[default0]:  retro_num_retrieved_chunks ...................... 2
[default0]:  retro_return_doc_ids ............................ False
[default0]:  retro_workdir ................................... None
[default0]:  return_data_index ............................... False
[default0]:  rotary_percent .................................. 1.0
[default0]:  sample_rate ..................................... 1.0
[default0]:  save ............................................ /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/checkpoint/gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true
[default0]:  save_interval ................................... 1000000
[default0]:  scatter_gather_tensors_in_pipeline .............. True
[default0]:  scattered_embeddings ............................ False
[default0]:  seed ............................................ 1234
[default0]:  seq_length ...................................... 2048
[default0]:  sequence_parallel ............................... False
[default0]:  sgd_momentum .................................... 0.9
[default0]:  short_seq_prob .................................. 0.1
[default0]:  skip_train ...................................... False
[default0]:  split ........................................... 98,2,0
[default0]:  split_transformers .............................. False
[default0]:  squared_relu .................................... False
[default0]:  standalone_embedding_stage ...................... False
[default0]:  start_weight_decay .............................. 0.1
[default0]:  swiglu .......................................... False
[default0]:  swin_backbone_type .............................. tiny
[default0]:  synchronize_each_layer .......................... False
[default0]:  tensor_model_parallel_size ...................... 1
[default0]:  tensorboard_dir ................................. /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/tensorboard/gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true_n2gpu1225_2023.07.30-22.21.45
[default0]:  tensorboard_log_interval ........................ 1
[default0]:  tensorboard_queue_size .......................... 1
[default0]:  test_data_path .................................. None
[default0]:  tile_factor ..................................... 1
[default0]:  timing_log_level ................................ 0
[default0]:  timing_log_option ............................... minmax
[default0]:  titles_data_path ................................ None
[default0]:  tokenizer_model ................................. None
[default0]:  tokenizer_type .................................. GPT2BPETokenizer
[default0]:  topk ............................................ 1
[default0]:  train_data_exact_num_epochs ..................... None
[default0]:  train_data_path ................................. None
[default0]:  train_desc_path ................................. None
[default0]:  train_doc_idx_path .............................. None
[default0]:  train_idx_path .................................. None
[default0]:  train_iters ..................................... 109863281
[default0]:  train_sample_idx_path ........................... None
[default0]:  train_samples ................................... None
[default0]:  train_shuffle_idx_path .......................... None
[default0]:  train_tokens .................................... 300000000000
[default0]:  transformer_impl ................................ local
[default0]:  transformer_pipeline_model_parallel_size ........ 1
[default0]:  untie_embeddings_and_output_weights ............. False
[default0]:  use_checkpoint_args ............................. False
[default0]:  use_checkpoint_opt_param_scheduler .............. False
[default0]:  use_contiguous_buffers_in_local_ddp ............. True
[default0]:  use_cpu_initialization .......................... None
[default0]:  use_distributed_optimizer ....................... False
[default0]:  use_flash_attn .................................. False
[default0]:  use_one_sent_docs ............................... False
[default0]:  use_pin_memory .................................. False
[default0]:  use_ring_exchange_p2p ........................... False
[default0]:  use_rotary_position_embeddings .................. False
[default0]:  use_tutel ....................................... False
[default0]:  valid_data_path ................................. None
[default0]:  variable_seq_lengths ............................ False
[default0]:  virtual_pipeline_model_parallel_size ............ None
[default0]:  vision_backbone_type ............................ vit
[default0]:  vision_pretraining .............................. False
[default0]:  vision_pretraining_type ......................... classify
[default0]:  vocab_extra_ids ................................. 0
[default0]:  vocab_file ...................................... /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/gpt2-vocab.json
[default0]:  vocab_size ...................................... None
[default0]:  weight_decay .................................... 0.1
[default0]:  weight_decay_incr_style ......................... constant
[default0]:  world_size ...................................... 1
[default0]:  zero_allgather_bucket_size ...................... 0.0
[default0]:  zero_contigious_gradients ....................... False
[default0]:  zero_reduce_bucket_size ......................... 0.0
[default0]:  zero_reduce_scatter ............................. False
[default0]:  zero_stage ...................................... 1.0
[default0]:-------------------- end of arguments ---------------------
[default0]:setting number of micro-batches to constant 1
[default0]:> building GPT2BPETokenizer tokenizer ...
[default0]: > padded vocab (size: 50257) with 47 dummy tokens (new size: 50304)
[default0]:> setting tensorboard ...
[default0]:> initializing torch distributed ...
[default0]:[2023-07-30 22:22:05,930] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default0]:[2023-07-30 22:22:05,930] [INFO] [comm.py:616:init_distributed] cdb=None
[default0]:[2023-07-30 22:22:05,930] [INFO] [comm.py:643:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[default0]:> initialized tensor model parallel with size 1
[default0]:> initialized pipeline model parallel with size 1
[default0]:> setting random seeds to 1234 ...
[default0]:> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
[default0]:> compiling dataset index builder ...
[default0]:make: Entering directory '/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/data'
[default0]:make: Nothing to be done for 'default'.
[default0]:make: Leaving directory '/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/data'
[default0]:>>> done with dataset index builder. Compilation time: 0.109 seconds
[default0]:> compiling and loading fused kernels ...
[default0]:Loading extension module scaled_upper_triang_masked_softmax_cuda...
[default0]:Detected CUDA files, patching ldflags
[default0]:Emitting ninja build file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/fused_kernels/build/build.ninja...
[default0]:Building extension module scaled_masked_softmax_cuda...
[default0]:Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[default0]:ninja: no work to do.
[default0]:Loading extension module scaled_masked_softmax_cuda...
[default0]:Detected CUDA files, patching ldflags
[default0]:Emitting ninja build file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/fused_kernels/build/build.ninja...
[default0]:Building extension module scaled_softmax_cuda...
[default0]:Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[default0]:ninja: no work to do.
[default0]:Loading extension module scaled_softmax_cuda...
[default0]:n2gpu1225:413786:413786 [0] NCCL INFO Bootstrap : Using ib1:10.10.103.93<0>
[default0]:n2gpu1225:413786:413786 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default0]:n2gpu1225:413786:413786 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.93<0>
[default0]:n2gpu1225:413786:413786 [0] NCCL INFO Using network IB
[default0]:NCCL version 2.12.12+cuda11.7
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 00/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 01/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 02/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 03/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 04/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 05/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 06/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 07/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 08/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 09/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 10/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 11/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 12/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 13/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 14/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 15/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 16/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 17/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 18/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 19/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 20/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 21/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 22/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 23/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 24/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 25/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 26/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 27/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 28/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 29/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 30/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Channel 31/32 :    0
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Connected all rings
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO Connected all trees
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
[default0]:n2gpu1225:413786:414017 [0] NCCL INFO comm 0x1548580090d0 rank 0 nranks 1 cudaDev 0 busId c4000 - Init COMPLETE
[default0]:>>> done with compiling and loading fused kernels. Compilation time: 1.810 seconds
[default0]:time to initialize megatron (seconds): 5.405
[default0]:[after megatron is initialized] datetime: 2023-07-30 22:22:08 
[default0]:building GPT model ...
[default0]:[2023-07-30 22:22:08,651] [INFO] [utils.py:785:see_memory_usage] Before Building Model
[default0]:[2023-07-30 22:22:08,652] [INFO] [utils.py:786:see_memory_usage] MA 0.0 GB         Max_MA 1.59 GB         CA 0.0 GB         Max_CA 2 GB 
[default0]:[2023-07-30 22:22:08,652] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 22.05 GB, percent = 4.4%
[default0]:[2023-07-30 22:22:08,810] [INFO] [utils.py:785:see_memory_usage] After Building Model
[default0]:[2023-07-30 22:22:08,810] [INFO] [utils.py:786:see_memory_usage] MA 1.41 GB         Max_MA 1.41 GB         CA 1.47 GB         Max_CA 1 GB 
[default0]:[2023-07-30 22:22:08,811] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 22.07 GB, percent = 4.4%
[default0]: > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 760372224
[default0]:param_group keyset: dict_keys(['name', 'params', 'wd_mult', 'lr_mult'])
[default0]:> learning rate decay style: cosine
[default0]:DeepSpeed is enabled.
[default0]:[2023-07-30 22:22:08,814] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.10.0, git-hash=unknown, git-branch=unknown
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 00/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 01/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 02/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 03/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 04/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 05/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 06/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 07/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 08/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 09/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 10/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 11/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 12/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 13/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 14/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 15/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 16/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 17/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 18/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 19/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 20/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 21/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 22/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 23/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 24/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 25/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 26/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 27/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 28/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 29/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 30/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Channel 31/32 :    0
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Connected all rings
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO Connected all trees
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
[default0]:n2gpu1225:413786:414152 [0] NCCL INFO comm 0x1546c80090d0 rank 0 nranks 1 cudaDev 0 busId c4000 - Init COMPLETE
[default0]:[2023-07-30 22:22:09,316] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[default0]:[2023-07-30 22:22:09,317] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the client Optimizer
[default0]:[2023-07-30 22:22:09,318] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[default0]:[2023-07-30 22:22:09,326] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[default0]:[2023-07-30 22:22:09,327] [INFO] [utils.py:54:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'apex.optimizers.fused_adam.FusedAdam'>
[default0]:[2023-07-30 22:22:09,327] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[default0]:[2023-07-30 22:22:09,327] [INFO] [stage_1_and_2.py:133:__init__] Reduce bucket size 500,000,000
[default0]:[2023-07-30 22:22:09,327] [INFO] [stage_1_and_2.py:134:__init__] Allgather bucket size 500,000,000
[default0]:[2023-07-30 22:22:09,327] [INFO] [stage_1_and_2.py:135:__init__] CPU Offload: False
[default0]:[2023-07-30 22:22:09,327] [INFO] [stage_1_and_2.py:136:__init__] Round robin gradient partitioning: False
[default0]:Rank: 0 partition count [1, 1] and sizes[(759889920, False), (482304, False)] 
[default0]:[2023-07-30 22:22:10,778] [INFO] [utils.py:785:see_memory_usage] Before initializing optimizer states
[default0]:[2023-07-30 22:22:10,779] [INFO] [utils.py:786:see_memory_usage] MA 4.25 GB         Max_MA 4.25 GB         CA 4.27 GB         Max_CA 4 GB 
[default0]:[2023-07-30 22:22:10,779] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 22.15 GB, percent = 4.4%
[default0]:[2023-07-30 22:22:10,864] [INFO] [utils.py:785:see_memory_usage] After initializing optimizer states
[default0]:[2023-07-30 22:22:10,864] [INFO] [utils.py:786:see_memory_usage] MA 9.91 GB         Max_MA 12.75 GB         CA 12.77 GB         Max_CA 13 GB 
[default0]:[2023-07-30 22:22:10,865] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 22.15 GB, percent = 4.4%
[default0]:[2023-07-30 22:22:10,865] [INFO] [stage_1_and_2.py:493:__init__] optimizer state initialized
[default0]:[2023-07-30 22:22:10,908] [INFO] [utils.py:785:see_memory_usage] After initializing ZeRO optimizer
[default0]:[2023-07-30 22:22:10,909] [INFO] [utils.py:786:see_memory_usage] MA 9.91 GB         Max_MA 9.91 GB         CA 12.77 GB         Max_CA 13 GB 
[default0]:[2023-07-30 22:22:10,909] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 22.15 GB, percent = 4.4%
[default0]:[2023-07-30 22:22:10,913] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
[default0]:[2023-07-30 22:22:10,913] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[default0]:[2023-07-30 22:22:10,913] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.optimizer_param_scheduler.OptimizerParamScheduler object at 0x1548dc28f730>
[default0]:[2023-07-30 22:22:10,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:10,914] [INFO] [config.py:960:print] DeepSpeedEngine configuration:
[default0]:[2023-07-30 22:22:10,914] [INFO] [config.py:964:print]   activation_checkpointing_config  {
[default0]:    "partition_activations": false, 
[default0]:    "contiguous_memory_optimization": false, 
[default0]:    "cpu_checkpointing": false, 
[default0]:    "number_checkpoints": null, 
[default0]:    "synchronize_checkpoint_boundary": false, 
[default0]:    "profile": false
[default0]:}
[default0]:[2023-07-30 22:22:10,914] [INFO] [config.py:964:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[default0]:[2023-07-30 22:22:10,914] [INFO] [config.py:964:print]   amp_enabled .................. False
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   amp_params ................... False
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   autotuning_config ............ {
[default0]:    "enabled": false, 
[default0]:    "start_step": null, 
[default0]:    "end_step": null, 
[default0]:    "metric_path": null, 
[default0]:    "arg_mappings": null, 
[default0]:    "metric": "throughput", 
[default0]:    "model_info": null, 
[default0]:    "results_dir": "autotuning_results", 
[default0]:    "exps_dir": "autotuning_exps", 
[default0]:    "overwrite": true, 
[default0]:    "fast": true, 
[default0]:    "start_profile_step": 3, 
[default0]:    "end_profile_step": 5, 
[default0]:    "tuner_type": "gridsearch", 
[default0]:    "tuner_early_stopping": 5, 
[default0]:    "tuner_num_trials": 50, 
[default0]:    "model_info_path": null, 
[default0]:    "mp_size": 1, 
[default0]:    "max_train_batch_size": null, 
[default0]:    "min_train_batch_size": 1, 
[default0]:    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
[default0]:    "min_train_micro_batch_size_per_gpu": 1, 
[default0]:    "num_tuning_micro_batch_sizes": 3
[default0]:}
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   bfloat16_enabled ............. False
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   checkpoint_parallel_write_pipeline  False
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   checkpoint_tag_validation_enabled  True
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   checkpoint_tag_validation_fail  False
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x1548dc2ef760>
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   communication_data_type ...... None
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   curriculum_enabled_legacy .... False
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   curriculum_params_legacy ..... {'curriculum_type': 'seqlen', 'min_difficulty': 80, 'max_difficulty': 2048, 'schedule_type': 'fixed_linear', 'schedule_config': {'total_curriculum_step': 14097744, 'difficulty_step': 8}}
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[default0]:[2023-07-30 22:22:10,915] [INFO] [config.py:964:print]   data_efficiency_enabled ...... False
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   dataloader_drop_last ......... False
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   disable_allgather ............ False
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   dump_state ................... False
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 500, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   eigenvalue_enabled ........... False
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   eigenvalue_gas_boundary_resolution  1
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   eigenvalue_layer_name ........ bert.encoder.layer
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   eigenvalue_layer_num ......... 0
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   eigenvalue_max_iter .......... 100
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   eigenvalue_stability ......... 1e-06
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   eigenvalue_tol ............... 0.01
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   eigenvalue_verbose ........... False
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   elasticity_enabled ........... False
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   flops_profiler_config ........ {
[default0]:    "enabled": false, 
[default0]:    "recompute_fwd_factor": 0.0, 
[default0]:    "profile_step": 1, 
[default0]:    "module_depth": -1, 
[default0]:    "top_modules": 1, 
[default0]:    "detailed": true, 
[default0]:    "output_file": null
[default0]:}
[default0]:[2023-07-30 22:22:10,916] [INFO] [config.py:964:print]   fp16_auto_cast ............... False
[default0]:[2023-07-30 22:22:10,917] [INFO] [config.py:964:print]   fp16_enabled ................. True
[default0]:[2023-07-30 22:22:10,917] [INFO] [config.py:964:print]   fp16_master_weights_and_gradients  False
[default0]:[2023-07-30 22:22:10,917] [INFO] [config.py:964:print]   global_rank .................. 0
[default0]:[2023-07-30 22:22:10,917] [INFO] [config.py:964:print]   grad_accum_dtype ............. None
[default0]:[2023-07-30 22:22:10,917] [INFO] [config.py:964:print]   gradient_accumulation_steps .. 1
[default0]:[2023-07-30 22:22:10,917] [INFO] [config.py:964:print]   gradient_clipping ............ 1
[default0]:[2023-07-30 22:22:10,917] [INFO] [config.py:964:print]   gradient_predivide_factor .... 1.0
[default0]:[2023-07-30 22:22:10,951] [INFO] [config.py:964:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[default0]:[2023-07-30 22:22:10,951] [INFO] [config.py:964:print]   initial_dynamic_scale ........ 2048
[default0]:[2023-07-30 22:22:10,951] [INFO] [config.py:964:print]   load_universal_checkpoint .... False
[default0]:[2023-07-30 22:22:10,951] [INFO] [config.py:964:print]   loss_scale ................... 0
[default0]:[2023-07-30 22:22:10,951] [INFO] [config.py:964:print]   memory_breakdown ............. False
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   mics_hierarchial_params_gather  False
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   mics_shard_size .............. -1
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   nebula_config ................ {
[default0]:    "enabled": false, 
[default0]:    "persistent_storage_path": null, 
[default0]:    "persistent_time_interval": 100, 
[default0]:    "num_of_version_in_retention": 2, 
[default0]:    "enable_nebula_load": true, 
[default0]:    "load_path": null
[default0]:}
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   optimizer_legacy_fusion ...... False
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   optimizer_name ............... None
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   optimizer_params ............. None
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   pld_enabled .................. False
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   pld_params ................... False
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   prescale_gradients ........... False
[default0]:[2023-07-30 22:22:10,952] [INFO] [config.py:964:print]   scheduler_name ............... None
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   scheduler_params ............. None
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   sparse_attention ............. None
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   sparse_gradients_enabled ..... False
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   steps_per_print .............. 5
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   train_batch_size ............. 4
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   train_micro_batch_size_per_gpu  4
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   use_node_local_storage ....... False
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   wall_clock_breakdown ......... False
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   world_size ................... 1
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   zero_allow_untested_optimizer  False
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   zero_enabled ................. True
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   zero_force_ds_cpu_optimizer .. True
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:964:print]   zero_optimization_stage ...... 2
[default0]:[2023-07-30 22:22:10,953] [INFO] [config.py:950:print_user_config]   json = {
[default0]:    "train_batch_size": 4, 
[default0]:    "train_micro_batch_size_per_gpu": 4, 
[default0]:    "steps_per_print": 5, 
[default0]:    "zero_optimization": {
[default0]:        "stage": 2
[default0]:    }, 
[default0]:    "gradient_clipping": 1, 
[default0]:    "prescale_gradients": false, 
[default0]:    "fp16": {
[default0]:        "enabled": true, 
[default0]:        "loss_scale": 0, 
[default0]:        "loss_scale_window": 500, 
[default0]:        "hysteresis": 2, 
[default0]:        "min_loss_scale": 1, 
[default0]:        "initial_scale_power": 11
[default0]:    }, 
[default0]:    "bf16": {
[default0]:        "enabled": false
[default0]:    }, 
[default0]:    "curriculum_learning": {
[default0]:        "enabled": false, 
[default0]:        "curriculum_type": "seqlen", 
[default0]:        "min_difficulty": 80, 
[default0]:        "max_difficulty": 2.048000e+03, 
[default0]:        "schedule_type": "fixed_linear", 
[default0]:        "schedule_config": {
[default0]:            "total_curriculum_step": 1.409774e+07, 
[default0]:            "difficulty_step": 8
[default0]:        }
[default0]:    }, 
[default0]:    "wall_clock_breakdown": false
[default0]:}
[default0]:[2023-07-30 22:22:10,955] [WARNING] [engine.py:2635:load_checkpoint] Unable to find latest file at /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/checkpoint/gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
[default0]:WARNING: could not find the metadata file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_0.76B_MoE128_4BATCH_1GPU_1Node/checkpoint/gpt-0.76B-lr-2.0e-4-minlr-2e-06-bs-4-gpus-1-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true 
[default0]:    will not load any checkpoints and will start from random
[default0]:(min, max) time across ranks (ms):
[default0]:    load-checkpoint ................................: (1.32, 1.32)
[default0]:[after model, optimizer, and learning rate scheduler are built] datetime: 2023-07-30 22:22:10 
[default0]:> building train, validation, and test datasets ...
[default0]: > datasets target sizes (minimum size):
[default0]:    train:      439453124
[default0]:    validation: 219726600
[default0]:    test:       200
[default0]:> building train, validation, and test datasets for GPT ...
[default0]:Single data path provided for train, valid & test
[default0]: > building dataset index ...
[default0]:    reading sizes...
[default0]:    reading pointers...
[default0]:    reading document index...
[default0]:    creating numpy buffer of mmap...
[default0]:    creating memory view of numpy buffer...
[default0]: > finished creating indexed dataset in 0.003241 seconds
[default0]:    number of documents: 10000
[default0]: > dataset split:
[default0]:    train:
[default0]:     document indices in [0, 9800) total of 9800 documents
[default0]:    validation:
[default0]:     document indices in [9800, 10000) total of 200 documents
[default0]:    test:
[default0]:     document indices in [10000, 10000) total of 0 documents
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 00/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 01/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 02/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 03/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 04/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 05/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 06/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 07/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 08/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 09/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 10/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 11/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 12/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 13/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 14/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 15/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 16/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 17/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 18/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 19/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 20/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 21/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 22/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 23/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 24/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 25/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 26/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 27/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 28/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 29/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 30/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Channel 31/32 :    0
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Connected all rings
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO Connected all trees
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
[default0]:n2gpu1225:413786:414159 [0] NCCL INFO comm 0x1548500090d0 rank 0 nranks 1 cudaDev 0 busId c4000 - Init COMPLETE
[default0]: > loading doc-idx mapping from /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/index-cache/71654a473c8694dd2b48f0197bdd21a9_doc_idx.npy
[default0]: > loading sample-idx mapping from /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/index-cache/71654a473c8694dd2b48f0197bdd21a9_sample_idx.npy
[default0]: > loading shuffle-idx mapping from /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/index-cache/71654a473c8694dd2b48f0197bdd21a9_shuffle_idx.npy
[default0]:    loaded indexed file in 0.049 seconds
[default0]:    total number of samples: 439466004
[default0]:    total number of epochs: 30909
[default0]: > loading doc-idx mapping from /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/index-cache/de3819301120d9a35080a0a129b3870d_doc_idx.npy
[default0]: > loading sample-idx mapping from /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/index-cache/de3819301120d9a35080a0a129b3870d_sample_idx.npy
[default0]: > loading shuffle-idx mapping from /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/index-cache/de3819301120d9a35080a0a129b3870d_shuffle_idx.npy
[default0]:    loaded indexed file in 0.090 seconds
[default0]:    total number of samples: 219726809
[default0]:    total number of epochs: 648115
[default0]:> finished creating GPT datasets ...
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 00/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 01/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 02/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 03/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 04/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 05/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 06/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 07/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 08/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 09/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 10/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 11/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 12/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 13/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 14/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 15/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 16/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 17/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 18/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 19/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 20/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 21/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 22/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 23/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 24/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 25/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 26/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 27/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 28/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 29/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 30/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Channel 31/32 :    0
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Connected all rings
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO Connected all trees
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
[default0]:n2gpu1225:413786:414168 [0] NCCL INFO comm 0x154850303de0 rank 0 nranks 1 cudaDev 0 busId c4000 - Init COMPLETE
[default0]:[after dataloaders are built] datetime: 2023-07-30 22:22:12 
[default0]:done with setup ...
[default0]:(min, max) time across ranks (ms):
[default0]:    model-and-optimizer-setup ......................: (2352.10, 2352.10)
[default0]:    train/valid/test-data-iterators-setup ..........: (1414.71, 1414.71)
[default0]:training ...
[default0]:[before the start of training step] datetime: 2023-07-30 22:22:12 
[default0]:[2023-07-30 22:22:18,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=5, skipped=0, lr=[1.7476266666666667e-08, 1.7476266666666667e-08], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:18,137] [INFO] [timer.py:215:stop] epoch=0/micro_step=5/global_step=5, RunningAvgSamplesPerSec=5.3646039819768845, CurrSamplesPerSec=5.363026885754006, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration        5/109863281 | consumed samples:           20 | consumed tokens:        40960 | elapsed time per iteration (ms): 1116.2 | learning rate: 1.748E-08 | global batch size:     4 | lm loss: 1.090857E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 3.583 | TFLOPs: 52.16 |
[default0]:[Rank 0] (after 5 iterations) memory (MB) | allocated: 10664.69287109375 | max allocated: 16463.11376953125 | reserved: 19630.0 | max reserved: 19630.0
[default0]:[2023-07-30 22:22:22,584] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=0, lr=[3.9321600000000005e-08, 3.9321600000000005e-08], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:22,589] [INFO] [timer.py:215:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=5.354551471726696, CurrSamplesPerSec=5.301131148302424, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       10/109863281 | consumed samples:           40 | consumed tokens:        81920 | elapsed time per iteration (ms): 891.1 | learning rate: 3.932E-08 | global batch size:     4 | lm loss: 1.090636E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.489 | TFLOPs: 65.34 |
[default0]:[2023-07-30 22:22:27,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=15, skipped=0, lr=[6.116693333333333e-08, 6.116693333333333e-08], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:27,370] [INFO] [timer.py:215:stop] epoch=0/micro_step=15/global_step=15, RunningAvgSamplesPerSec=5.354434888544879, CurrSamplesPerSec=5.35149016524431, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       15/109863281 | consumed samples:           60 | consumed tokens:       122880 | elapsed time per iteration (ms): 955.7 | learning rate: 6.117E-08 | global batch size:     4 | lm loss: 1.088158E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.185 | TFLOPs: 60.92 |
[default0]:[2023-07-30 22:22:31,725] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=0, lr=[8.301226666666667e-08, 8.301226666666667e-08], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:31,726] [INFO] [timer.py:215:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=5.356852524512812, CurrSamplesPerSec=5.328954268524127, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       20/109863281 | consumed samples:           80 | consumed tokens:       163840 | elapsed time per iteration (ms): 871.6 | learning rate: 8.301E-08 | global batch size:     4 | lm loss: 1.082375E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.589 | TFLOPs: 66.80 |
[default0]:[2023-07-30 22:22:36,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=25, skipped=0, lr=[1.048576e-07, 1.048576e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:36,283] [INFO] [timer.py:215:stop] epoch=0/micro_step=25/global_step=25, RunningAvgSamplesPerSec=5.353214997948477, CurrSamplesPerSec=5.3675033640443015, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       25/109863281 | consumed samples:          100 | consumed tokens:       204800 | elapsed time per iteration (ms): 911.1 | learning rate: 1.049E-07 | global batch size:     4 | lm loss: 1.071945E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.390 | TFLOPs: 63.91 |
[default0]:[2023-07-30 22:22:40,842] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=0, lr=[1.2670293333333334e-07, 1.2670293333333334e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:40,842] [INFO] [timer.py:215:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=5.355598431419367, CurrSamplesPerSec=5.347994838551735, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       30/109863281 | consumed samples:          120 | consumed tokens:       245760 | elapsed time per iteration (ms): 912.3 | learning rate: 1.267E-07 | global batch size:     4 | lm loss: 1.061702E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.385 | TFLOPs: 63.82 |
[default0]:[2023-07-30 22:22:45,329] [INFO] [logging.py:96:log_dist] [Rank 0] step=35, skipped=0, lr=[1.4854826666666668e-07, 1.4854826666666668e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:45,330] [INFO] [timer.py:215:stop] epoch=0/micro_step=35/global_step=35, RunningAvgSamplesPerSec=5.352464461724858, CurrSamplesPerSec=5.341917480743777, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       35/109863281 | consumed samples:          140 | consumed tokens:       286720 | elapsed time per iteration (ms): 897.2 | learning rate: 1.485E-07 | global batch size:     4 | lm loss: 1.050775E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.458 | TFLOPs: 64.90 |
[default0]:[2023-07-30 22:22:49,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=0, lr=[1.7039360000000002e-07, 1.7039360000000002e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:49,681] [INFO] [timer.py:215:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=5.354218463151327, CurrSamplesPerSec=5.371227151288524, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       40/109863281 | consumed samples:          160 | consumed tokens:       327680 | elapsed time per iteration (ms): 870.1 | learning rate: 1.704E-07 | global batch size:     4 | lm loss: 1.044249E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.597 | TFLOPs: 66.92 |
[default0]:[2023-07-30 22:22:54,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=45, skipped=0, lr=[1.9223893333333335e-07, 1.9223893333333335e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:54,175] [INFO] [timer.py:215:stop] epoch=0/micro_step=45/global_step=45, RunningAvgSamplesPerSec=5.353198846317916, CurrSamplesPerSec=5.342439702888135, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       45/109863281 | consumed samples:          180 | consumed tokens:       368640 | elapsed time per iteration (ms): 899.3 | learning rate: 1.922E-07 | global batch size:     4 | lm loss: 1.029628E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.448 | TFLOPs: 64.74 |
[default0]:[2023-07-30 22:22:58,624] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=0, lr=[2.1408426666666666e-07, 2.1408426666666666e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:22:58,625] [INFO] [timer.py:215:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=5.35422835953764, CurrSamplesPerSec=5.363249760803483, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       50/109863281 | consumed samples:          200 | consumed tokens:       409600 | elapsed time per iteration (ms): 889.7 | learning rate: 2.141E-07 | global batch size:     4 | lm loss: 1.017961E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.496 | TFLOPs: 65.44 |
[default0]:[2023-07-30 22:23:03,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=55, skipped=0, lr=[2.359296e-07, 2.359296e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:03,158] [INFO] [timer.py:215:stop] epoch=0/micro_step=55/global_step=55, RunningAvgSamplesPerSec=5.353837170498312, CurrSamplesPerSec=5.305573642545491, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       55/109863281 | consumed samples:          220 | consumed tokens:       450560 | elapsed time per iteration (ms): 906.8 | learning rate: 2.359E-07 | global batch size:     4 | lm loss: 1.005813E+01 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.411 | TFLOPs: 64.21 |
[default0]:[2023-07-30 22:23:07,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=0, lr=[2.577749333333333e-07, 2.577749333333333e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:07,616] [INFO] [timer.py:215:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=5.353394807462153, CurrSamplesPerSec=5.366617427191578, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       60/109863281 | consumed samples:          240 | consumed tokens:       491520 | elapsed time per iteration (ms): 891.3 | learning rate: 2.578E-07 | global batch size:     4 | lm loss: 9.996658E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.488 | TFLOPs: 65.32 |
[default0]:[2023-07-30 22:23:12,033] [INFO] [logging.py:96:log_dist] [Rank 0] step=65, skipped=0, lr=[2.796202666666667e-07, 2.796202666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:12,035] [INFO] [timer.py:215:stop] epoch=0/micro_step=65/global_step=65, RunningAvgSamplesPerSec=5.354011837402323, CurrSamplesPerSec=5.341337542589749, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       65/109863281 | consumed samples:          260 | consumed tokens:       532480 | elapsed time per iteration (ms): 883.7 | learning rate: 2.796E-07 | global batch size:     4 | lm loss: 9.961158E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.526 | TFLOPs: 65.89 |
[default0]:[2023-07-30 22:23:16,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=0, lr=[3.0146560000000004e-07, 3.0146560000000004e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:16,443] [INFO] [timer.py:215:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=5.353248283970221, CurrSamplesPerSec=5.363292623513661, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       70/109863281 | consumed samples:          280 | consumed tokens:       573440 | elapsed time per iteration (ms): 882.0 | learning rate: 3.015E-07 | global batch size:     4 | lm loss: 9.851508E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.535 | TFLOPs: 66.02 |
[default0]:[2023-07-30 22:23:21,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=75, skipped=0, lr=[3.2331093333333335e-07, 3.2331093333333335e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:21,101] [INFO] [timer.py:215:stop] epoch=0/micro_step=75/global_step=75, RunningAvgSamplesPerSec=5.354295345195292, CurrSamplesPerSec=5.340740728950632, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       75/109863281 | consumed samples:          300 | consumed tokens:       614400 | elapsed time per iteration (ms): 931.4 | learning rate: 3.233E-07 | global batch size:     4 | lm loss: 9.799759E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.295 | TFLOPs: 62.51 |
[default0]:[2023-07-30 22:23:25,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=0, lr=[3.451562666666667e-07, 3.451562666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:25,558] [INFO] [timer.py:215:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=5.353768339476368, CurrSamplesPerSec=5.339207648490723, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       80/109863281 | consumed samples:          320 | consumed tokens:       655360 | elapsed time per iteration (ms): 891.2 | learning rate: 3.452E-07 | global batch size:     4 | lm loss: 9.770224E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.488 | TFLOPs: 65.33 |
[default0]:[2023-07-30 22:23:29,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=85, skipped=0, lr=[3.670016000000001e-07, 3.670016000000001e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:29,971] [INFO] [timer.py:215:stop] epoch=0/micro_step=85/global_step=85, RunningAvgSamplesPerSec=5.354902256797838, CurrSamplesPerSec=5.37076118043182, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       85/109863281 | consumed samples:          340 | consumed tokens:       696320 | elapsed time per iteration (ms): 882.7 | learning rate: 3.670E-07 | global batch size:     4 | lm loss: 9.723230E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.531 | TFLOPs: 65.96 |
[default0]:[2023-07-30 22:23:34,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=0, lr=[3.8884693333333334e-07, 3.8884693333333334e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:34,435] [INFO] [timer.py:215:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=5.354766651199908, CurrSamplesPerSec=5.3420722655864425, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       90/109863281 | consumed samples:          360 | consumed tokens:       737280 | elapsed time per iteration (ms): 892.9 | learning rate: 3.888E-07 | global batch size:     4 | lm loss: 9.793986E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.480 | TFLOPs: 65.21 |
[default0]:[2023-07-30 22:23:39,081] [INFO] [logging.py:96:log_dist] [Rank 0] step=95, skipped=0, lr=[4.106922666666667e-07, 4.106922666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:39,082] [INFO] [timer.py:215:stop] epoch=0/micro_step=95/global_step=95, RunningAvgSamplesPerSec=5.355122503953428, CurrSamplesPerSec=5.371056916399296, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration       95/109863281 | consumed samples:          380 | consumed tokens:       778240 | elapsed time per iteration (ms): 929.2 | learning rate: 4.107E-07 | global batch size:     4 | lm loss: 9.732176E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.305 | TFLOPs: 62.66 |
[default0]:[2023-07-30 22:23:43,505] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=0, lr=[4.325376e-07, 4.325376e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:23:43,506] [INFO] [timer.py:215:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=5.351780054777126, CurrSamplesPerSec=5.059300132625115, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      100/109863281 | consumed samples:          400 | consumed tokens:       819200 | elapsed time per iteration (ms): 885.1 | learning rate: 4.325E-07 | global batch size:     4 | lm loss: 9.665448E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.519 | TFLOPs: 65.78 |
[default0]:-----------------------------------------------------------------------------------------------
[default0]: validation loss at iteration 100 | lm loss value: 9.662731E+00 | lm loss PPL: 1.572066E+04 | 
[default0]:-----------------------------------------------------------------------------------------------
[default0]:[2023-07-30 22:24:02,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=105, skipped=0, lr=[4.543829333333334e-07, 4.543829333333334e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:02,127] [INFO] [timer.py:215:stop] epoch=0/micro_step=105/global_step=105, RunningAvgSamplesPerSec=5.352425806002634, CurrSamplesPerSec=5.325065733260712, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      105/109863281 | consumed samples:          420 | consumed tokens:       860160 | elapsed time per iteration (ms): 3724.3 | learning rate: 4.544E-07 | global batch size:     4 | lm loss: 9.710948E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 1.074 | TFLOPs: 15.63 |
[default0]:[2023-07-30 22:24:06,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=0, lr=[4.762282666666667e-07, 4.762282666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:06,889] [INFO] [timer.py:215:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=5.352674616200157, CurrSamplesPerSec=5.375800015252119, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      110/109863281 | consumed samples:          440 | consumed tokens:       901120 | elapsed time per iteration (ms): 952.1 | learning rate: 4.762E-07 | global batch size:     4 | lm loss: 9.700012E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.201 | TFLOPs: 61.15 |
[default0]:[2023-07-30 22:24:11,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=115, skipped=0, lr=[4.980736e-07, 4.980736e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:11,767] [INFO] [timer.py:215:stop] epoch=0/micro_step=115/global_step=115, RunningAvgSamplesPerSec=5.353169065380691, CurrSamplesPerSec=5.3263691722852045, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      115/109863281 | consumed samples:          460 | consumed tokens:       942080 | elapsed time per iteration (ms): 975.8 | learning rate: 4.981E-07 | global batch size:     4 | lm loss: 9.705016E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.099 | TFLOPs: 59.67 |
[default0]:[2023-07-30 22:24:16,475] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=0, lr=[5.199189333333334e-07, 5.199189333333334e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:16,478] [INFO] [timer.py:215:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=5.352828645555348, CurrSamplesPerSec=5.329687281599044, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      120/109863281 | consumed samples:          480 | consumed tokens:       983040 | elapsed time per iteration (ms): 942.1 | learning rate: 5.199E-07 | global batch size:     4 | lm loss: 9.681686E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.246 | TFLOPs: 61.80 |
[default0]:[2023-07-30 22:24:21,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=125, skipped=0, lr=[5.417642666666667e-07, 5.417642666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:21,037] [INFO] [timer.py:215:stop] epoch=0/micro_step=125/global_step=125, RunningAvgSamplesPerSec=5.353682025744552, CurrSamplesPerSec=5.36107152306538, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      125/109863281 | consumed samples:          500 | consumed tokens:      1024000 | elapsed time per iteration (ms): 911.6 | learning rate: 5.418E-07 | global batch size:     4 | lm loss: 9.598695E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.388 | TFLOPs: 63.87 |
[default0]:[2023-07-30 22:24:25,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=0, lr=[5.636096e-07, 5.636096e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:25,491] [INFO] [timer.py:215:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=5.353208476599328, CurrSamplesPerSec=5.342002526250365, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      130/109863281 | consumed samples:          520 | consumed tokens:      1064960 | elapsed time per iteration (ms): 890.7 | learning rate: 5.636E-07 | global batch size:     4 | lm loss: 9.601179E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.491 | TFLOPs: 65.37 |
[default0]:[2023-07-30 22:24:29,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=135, skipped=0, lr=[5.854549333333333e-07, 5.854549333333333e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:29,935] [INFO] [timer.py:215:stop] epoch=0/micro_step=135/global_step=135, RunningAvgSamplesPerSec=5.353736472535647, CurrSamplesPerSec=5.368449716509698, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      135/109863281 | consumed samples:          540 | consumed tokens:      1105920 | elapsed time per iteration (ms): 889.0 | learning rate: 5.855E-07 | global batch size:     4 | lm loss: 9.569453E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.499 | TFLOPs: 65.49 |
[default0]:[2023-07-30 22:24:34,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=0, lr=[6.073002666666667e-07, 6.073002666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:34,496] [INFO] [timer.py:215:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=5.353389636769592, CurrSamplesPerSec=5.345505350375092, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      140/109863281 | consumed samples:          560 | consumed tokens:      1146880 | elapsed time per iteration (ms): 912.0 | learning rate: 6.073E-07 | global batch size:     4 | lm loss: 9.575602E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.386 | TFLOPs: 63.84 |
[default0]:[2023-07-30 22:24:38,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=145, skipped=0, lr=[6.291456000000001e-07, 6.291456000000001e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:38,998] [INFO] [timer.py:215:stop] epoch=0/micro_step=145/global_step=145, RunningAvgSamplesPerSec=5.353905241039837, CurrSamplesPerSec=5.376914722018979, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      145/109863281 | consumed samples:          580 | consumed tokens:      1187840 | elapsed time per iteration (ms): 900.4 | learning rate: 6.291E-07 | global batch size:     4 | lm loss: 9.664372E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.443 | TFLOPs: 64.67 |
[default0]:[2023-07-30 22:24:43,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[6.509909333333333e-07, 6.509909333333333e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:43,335] [INFO] [timer.py:215:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=5.353862552380395, CurrSamplesPerSec=5.301129473293735, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      150/109863281 | consumed samples:          600 | consumed tokens:      1228800 | elapsed time per iteration (ms): 867.6 | learning rate: 6.510E-07 | global batch size:     4 | lm loss: 9.595719E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.611 | TFLOPs: 67.11 |
[default0]:[2023-07-30 22:24:47,726] [INFO] [logging.py:96:log_dist] [Rank 0] step=155, skipped=0, lr=[6.728362666666667e-07, 6.728362666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:47,727] [INFO] [timer.py:215:stop] epoch=0/micro_step=155/global_step=155, RunningAvgSamplesPerSec=5.354009074300109, CurrSamplesPerSec=5.363891058495617, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      155/109863281 | consumed samples:          620 | consumed tokens:      1269760 | elapsed time per iteration (ms): 879.5 | learning rate: 6.728E-07 | global batch size:     4 | lm loss: 9.599771E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.548 | TFLOPs: 66.20 |
[default0]:[2023-07-30 22:24:52,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=0, lr=[6.946816000000001e-07, 6.946816000000001e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:52,227] [INFO] [timer.py:215:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=5.3529909389142425, CurrSamplesPerSec=5.3415501152699125, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      160/109863281 | consumed samples:          640 | consumed tokens:      1310720 | elapsed time per iteration (ms): 899.5 | learning rate: 6.947E-07 | global batch size:     4 | lm loss: 9.551467E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.447 | TFLOPs: 64.73 |
[default0]:[2023-07-30 22:24:56,759] [INFO] [logging.py:96:log_dist] [Rank 0] step=165, skipped=0, lr=[7.165269333333334e-07, 7.165269333333334e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:24:56,760] [INFO] [timer.py:215:stop] epoch=0/micro_step=165/global_step=165, RunningAvgSamplesPerSec=5.352801502924386, CurrSamplesPerSec=5.348820067461152, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      165/109863281 | consumed samples:          660 | consumed tokens:      1351680 | elapsed time per iteration (ms): 905.7 | learning rate: 7.165E-07 | global batch size:     4 | lm loss: 9.520973E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.416 | TFLOPs: 64.28 |
[default0]:[2023-07-30 22:25:01,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=0, lr=[7.383722666666668e-07, 7.383722666666668e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:01,319] [INFO] [timer.py:215:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=5.353379163034908, CurrSamplesPerSec=5.367211453316067, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      170/109863281 | consumed samples:          680 | consumed tokens:      1392640 | elapsed time per iteration (ms): 912.1 | learning rate: 7.384E-07 | global batch size:     4 | lm loss: 9.489433E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.385 | TFLOPs: 63.83 |
[default0]:[2023-07-30 22:25:05,820] [INFO] [logging.py:96:log_dist] [Rank 0] step=175, skipped=0, lr=[7.602176000000001e-07, 7.602176000000001e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:05,822] [INFO] [timer.py:215:stop] epoch=0/micro_step=175/global_step=175, RunningAvgSamplesPerSec=5.353032351985813, CurrSamplesPerSec=5.3288916416535645, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      175/109863281 | consumed samples:          700 | consumed tokens:      1433600 | elapsed time per iteration (ms): 900.6 | learning rate: 7.602E-07 | global batch size:     4 | lm loss: 9.376167E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.442 | TFLOPs: 64.65 |
[default0]:[2023-07-30 22:25:10,167] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=0, lr=[7.820629333333333e-07, 7.820629333333333e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:10,168] [INFO] [timer.py:215:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=5.353349976363814, CurrSamplesPerSec=5.342819100913557, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      180/109863281 | consumed samples:          720 | consumed tokens:      1474560 | elapsed time per iteration (ms): 869.0 | learning rate: 7.821E-07 | global batch size:     4 | lm loss: 9.371642E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.603 | TFLOPs: 67.00 |
[default0]:[2023-07-30 22:25:14,578] [INFO] [logging.py:96:log_dist] [Rank 0] step=185, skipped=0, lr=[8.039082666666667e-07, 8.039082666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:14,580] [INFO] [timer.py:215:stop] epoch=0/micro_step=185/global_step=185, RunningAvgSamplesPerSec=5.353046277421719, CurrSamplesPerSec=5.34493995820825, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      185/109863281 | consumed samples:          740 | consumed tokens:      1515520 | elapsed time per iteration (ms): 882.3 | learning rate: 8.039E-07 | global batch size:     4 | lm loss: 9.444930E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.533 | TFLOPs: 65.99 |
[default0]:[2023-07-30 22:25:19,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=0, lr=[8.257536e-07, 8.257536e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:19,028] [INFO] [timer.py:215:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=5.353382599752213, CurrSamplesPerSec=5.3691249050326455, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      190/109863281 | consumed samples:          760 | consumed tokens:      1556480 | elapsed time per iteration (ms): 889.7 | learning rate: 8.258E-07 | global batch size:     4 | lm loss: 9.364245E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.496 | TFLOPs: 65.44 |
[default0]:[2023-07-30 22:25:23,440] [INFO] [logging.py:96:log_dist] [Rank 0] step=195, skipped=0, lr=[8.475989333333334e-07, 8.475989333333334e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:23,443] [INFO] [timer.py:215:stop] epoch=0/micro_step=195/global_step=195, RunningAvgSamplesPerSec=5.353365294407617, CurrSamplesPerSec=5.300400944879004, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      195/109863281 | consumed samples:          780 | consumed tokens:      1597440 | elapsed time per iteration (ms): 883.2 | learning rate: 8.476E-07 | global batch size:     4 | lm loss: 9.381454E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.529 | TFLOPs: 65.93 |
[default0]:[2023-07-30 22:25:27,898] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[8.694442666666668e-07, 8.694442666666668e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:27,899] [INFO] [timer.py:215:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=5.353539417229189, CurrSamplesPerSec=5.361806544726581, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      200/109863281 | consumed samples:          800 | consumed tokens:      1638400 | elapsed time per iteration (ms): 892.2 | learning rate: 8.694E-07 | global batch size:     4 | lm loss: 9.360617E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.483 | TFLOPs: 65.26 |
[default0]:-----------------------------------------------------------------------------------------------
[default0]: validation loss at iteration 200 | lm loss value: 9.324981E+00 | lm loss PPL: 1.121470E+04 | 
[default0]:-----------------------------------------------------------------------------------------------
[default0]:[2023-07-30 22:25:45,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=205, skipped=0, lr=[8.912896e-07, 8.912896e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:45,317] [INFO] [timer.py:215:stop] epoch=0/micro_step=205/global_step=205, RunningAvgSamplesPerSec=5.353359150081988, CurrSamplesPerSec=5.3449297413778, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      205/109863281 | consumed samples:          820 | consumed tokens:      1679360 | elapsed time per iteration (ms): 3482.5 | learning rate: 8.913E-07 | global batch size:     4 | lm loss: 9.337230E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 1.149 | TFLOPs: 16.72 |
[default0]:[2023-07-30 22:25:49,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=0, lr=[9.131349333333334e-07, 9.131349333333334e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:49,753] [INFO] [timer.py:215:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=5.353677361216538, CurrSamplesPerSec=5.365295933339047, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      210/109863281 | consumed samples:          840 | consumed tokens:      1720320 | elapsed time per iteration (ms): 886.8 | learning rate: 9.131E-07 | global batch size:     4 | lm loss: 9.303961E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.510 | TFLOPs: 65.65 |
[default0]:[2023-07-30 22:25:54,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=215, skipped=0, lr=[9.349802666666667e-07, 9.349802666666667e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:54,149] [INFO] [timer.py:215:stop] epoch=0/micro_step=215/global_step=215, RunningAvgSamplesPerSec=5.353447710325179, CurrSamplesPerSec=5.293460670917073, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      215/109863281 | consumed samples:          860 | consumed tokens:      1761280 | elapsed time per iteration (ms): 879.4 | learning rate: 9.350E-07 | global batch size:     4 | lm loss: 9.336625E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.549 | TFLOPs: 66.21 |
[default0]:[2023-07-30 22:25:58,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=0, lr=[9.568256e-07, 9.568256e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:25:58,501] [INFO] [timer.py:215:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=5.353589232349353, CurrSamplesPerSec=5.370578940764016, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      220/109863281 | consumed samples:          880 | consumed tokens:      1802240 | elapsed time per iteration (ms): 870.4 | learning rate: 9.568E-07 | global batch size:     4 | lm loss: 9.194435E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.596 | TFLOPs: 66.89 |
[default0]:[2023-07-30 22:26:02,858] [INFO] [logging.py:96:log_dist] [Rank 0] step=225, skipped=0, lr=[9.786709333333333e-07, 9.786709333333333e-07], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:02,860] [INFO] [timer.py:215:stop] epoch=0/micro_step=225/global_step=225, RunningAvgSamplesPerSec=5.353775177559277, CurrSamplesPerSec=5.328057321371691, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      225/109863281 | consumed samples:          900 | consumed tokens:      1843200 | elapsed time per iteration (ms): 871.7 | learning rate: 9.787E-07 | global batch size:     4 | lm loss: 9.257941E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.589 | TFLOPs: 66.80 |
[default0]:[2023-07-30 22:26:07,205] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=0, lr=[1.0005162666666667e-06, 1.0005162666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:07,206] [INFO] [timer.py:215:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=5.353836440392377, CurrSamplesPerSec=5.366296433123668, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      230/109863281 | consumed samples:          920 | consumed tokens:      1884160 | elapsed time per iteration (ms): 870.1 | learning rate: 1.001E-06 | global batch size:     4 | lm loss: 9.222624E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.597 | TFLOPs: 66.91 |
[default0]:[2023-07-30 22:26:11,479] [INFO] [logging.py:96:log_dist] [Rank 0] step=235, skipped=0, lr=[1.0223616e-06, 1.0223616e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:11,479] [INFO] [timer.py:215:stop] epoch=0/micro_step=235/global_step=235, RunningAvgSamplesPerSec=5.354177611725174, CurrSamplesPerSec=5.352576027646591, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      235/109863281 | consumed samples:          940 | consumed tokens:      1925120 | elapsed time per iteration (ms): 853.8 | learning rate: 1.022E-06 | global batch size:     4 | lm loss: 9.226462E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.685 | TFLOPs: 68.19 |
[default0]:[2023-07-30 22:26:15,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=0, lr=[1.0442069333333335e-06, 1.0442069333333335e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:15,904] [INFO] [timer.py:215:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=5.3538529644551485, CurrSamplesPerSec=5.333591049779119, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      240/109863281 | consumed samples:          960 | consumed tokens:      1966080 | elapsed time per iteration (ms): 885.2 | learning rate: 1.044E-06 | global batch size:     4 | lm loss: 9.221255E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.519 | TFLOPs: 65.78 |
[default0]:[2023-07-30 22:26:20,260] [INFO] [logging.py:96:log_dist] [Rank 0] step=245, skipped=0, lr=[1.0660522666666667e-06, 1.0660522666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:20,261] [INFO] [timer.py:215:stop] epoch=0/micro_step=245/global_step=245, RunningAvgSamplesPerSec=5.354151967837755, CurrSamplesPerSec=5.371731041014433, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      245/109863281 | consumed samples:          980 | consumed tokens:      2007040 | elapsed time per iteration (ms): 871.2 | learning rate: 1.066E-06 | global batch size:     4 | lm loss: 9.212784E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.591 | TFLOPs: 66.83 |
[default0]:[2023-07-30 22:26:24,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=0, lr=[1.0878976000000002e-06, 1.0878976000000002e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:24,646] [INFO] [timer.py:215:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=5.354026927396492, CurrSamplesPerSec=5.324087305402942, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      250/109863281 | consumed samples:         1000 | consumed tokens:      2048000 | elapsed time per iteration (ms): 876.8 | learning rate: 1.088E-06 | global batch size:     4 | lm loss: 9.168208E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.562 | TFLOPs: 66.40 |
[default0]:[2023-07-30 22:26:29,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=255, skipped=0, lr=[1.1097429333333334e-06, 1.1097429333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:29,035] [INFO] [timer.py:215:stop] epoch=0/micro_step=255/global_step=255, RunningAvgSamplesPerSec=5.354194774108355, CurrSamplesPerSec=5.374926835363148, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      255/109863281 | consumed samples:         1020 | consumed tokens:      2088960 | elapsed time per iteration (ms): 878.0 | learning rate: 1.110E-06 | global batch size:     4 | lm loss: 9.189677E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.556 | TFLOPs: 66.32 |
[default0]:[2023-07-30 22:26:33,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=0, lr=[1.1315882666666667e-06, 1.1315882666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:33,398] [INFO] [timer.py:215:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=5.354280487953164, CurrSamplesPerSec=5.346542781351937, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      260/109863281 | consumed samples:         1040 | consumed tokens:      2129920 | elapsed time per iteration (ms): 872.3 | learning rate: 1.132E-06 | global batch size:     4 | lm loss: 9.076085E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.585 | TFLOPs: 66.75 |
[default0]:[2023-07-30 22:26:37,802] [INFO] [logging.py:96:log_dist] [Rank 0] step=265, skipped=0, lr=[1.1534336e-06, 1.1534336e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:37,803] [INFO] [timer.py:215:stop] epoch=0/micro_step=265/global_step=265, RunningAvgSamplesPerSec=5.354004624381657, CurrSamplesPerSec=5.357052174468357, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      265/109863281 | consumed samples:         1060 | consumed tokens:      2170880 | elapsed time per iteration (ms): 881.1 | learning rate: 1.153E-06 | global batch size:     4 | lm loss: 9.128264E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.540 | TFLOPs: 66.08 |
[default0]:[2023-07-30 22:26:42,365] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=0, lr=[1.1752789333333334e-06, 1.1752789333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:42,367] [INFO] [timer.py:215:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=5.354113946028508, CurrSamplesPerSec=5.315314447635148, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      270/109863281 | consumed samples:         1080 | consumed tokens:      2211840 | elapsed time per iteration (ms): 913.1 | learning rate: 1.175E-06 | global batch size:     4 | lm loss: 9.209808E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.381 | TFLOPs: 63.76 |
[default0]:[2023-07-30 22:26:46,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=275, skipped=0, lr=[1.1971242666666667e-06, 1.1971242666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:46,909] [INFO] [timer.py:215:stop] epoch=0/micro_step=275/global_step=275, RunningAvgSamplesPerSec=5.3538960185454565, CurrSamplesPerSec=5.338830462095491, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      275/109863281 | consumed samples:         1100 | consumed tokens:      2252800 | elapsed time per iteration (ms): 909.0 | learning rate: 1.197E-06 | global batch size:     4 | lm loss: 9.227460E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.400 | TFLOPs: 64.05 |
[default0]:[2023-07-30 22:26:51,348] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=0, lr=[1.2189696000000002e-06, 1.2189696000000002e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:51,349] [INFO] [timer.py:215:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=5.354273136776357, CurrSamplesPerSec=5.3754761994779985, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      280/109863281 | consumed samples:         1120 | consumed tokens:      2293760 | elapsed time per iteration (ms): 887.2 | learning rate: 1.219E-06 | global batch size:     4 | lm loss: 9.020702E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.509 | TFLOPs: 65.63 |
[default0]:[2023-07-30 22:26:55,806] [INFO] [logging.py:96:log_dist] [Rank 0] step=285, skipped=0, lr=[1.2408149333333334e-06, 1.2408149333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:26:55,808] [INFO] [timer.py:215:stop] epoch=0/micro_step=285/global_step=285, RunningAvgSamplesPerSec=5.35409605660467, CurrSamplesPerSec=5.333813180646936, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      285/109863281 | consumed samples:         1140 | consumed tokens:      2334720 | elapsed time per iteration (ms): 892.0 | learning rate: 1.241E-06 | global batch size:     4 | lm loss: 9.071241E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.484 | TFLOPs: 65.27 |
[default0]:[2023-07-30 22:27:00,260] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=0, lr=[1.2626602666666667e-06, 1.2626602666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:00,261] [INFO] [timer.py:215:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=5.3543720926535485, CurrSamplesPerSec=5.3746289513121335, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      290/109863281 | consumed samples:         1160 | consumed tokens:      2375680 | elapsed time per iteration (ms): 891.1 | learning rate: 1.263E-06 | global batch size:     4 | lm loss: 9.151506E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.489 | TFLOPs: 65.34 |
[default0]:[2023-07-30 22:27:04,647] [INFO] [logging.py:96:log_dist] [Rank 0] step=295, skipped=0, lr=[1.2845056000000001e-06, 1.2845056000000001e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:04,649] [INFO] [timer.py:215:stop] epoch=0/micro_step=295/global_step=295, RunningAvgSamplesPerSec=5.354154771606574, CurrSamplesPerSec=5.338759108502032, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      295/109863281 | consumed samples:         1180 | consumed tokens:      2416640 | elapsed time per iteration (ms): 876.9 | learning rate: 1.285E-06 | global batch size:     4 | lm loss: 9.055642E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.561 | TFLOPs: 66.40 |
[default0]:[2023-07-30 22:27:09,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=0, lr=[1.3063509333333334e-06, 1.3063509333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:09,134] [INFO] [timer.py:215:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=5.3542248794802845, CurrSamplesPerSec=5.377676503122487, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      300/109863281 | consumed samples:         1200 | consumed tokens:      2457600 | elapsed time per iteration (ms): 896.8 | learning rate: 1.306E-06 | global batch size:     4 | lm loss: 9.093369E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.460 | TFLOPs: 64.92 |
[default0]:-----------------------------------------------------------------------------------------------
[default0]: validation loss at iteration 300 | lm loss value: 9.124219E+00 | lm loss PPL: 9.174828E+03 | 
[default0]:-----------------------------------------------------------------------------------------------
[default0]:[2023-07-30 22:27:24,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=305, skipped=0, lr=[1.3281962666666667e-06, 1.3281962666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:24,770] [INFO] [timer.py:215:stop] epoch=0/micro_step=305/global_step=305, RunningAvgSamplesPerSec=5.354115183125133, CurrSamplesPerSec=5.339525409919544, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      305/109863281 | consumed samples:         1220 | consumed tokens:      2498560 | elapsed time per iteration (ms): 3128.3 | learning rate: 1.328E-06 | global batch size:     4 | lm loss: 9.015549E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 1.279 | TFLOPs: 18.61 |
[default0]:[2023-07-30 22:27:29,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=0, lr=[1.3500416e-06, 1.3500416e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:29,309] [INFO] [timer.py:215:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=5.354225769626784, CurrSamplesPerSec=5.369245185439314, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      310/109863281 | consumed samples:         1240 | consumed tokens:      2539520 | elapsed time per iteration (ms): 906.4 | learning rate: 1.350E-06 | global batch size:     4 | lm loss: 9.087134E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.413 | TFLOPs: 64.23 |
[default0]:[2023-07-30 22:27:33,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=315, skipped=0, lr=[1.3718869333333336e-06, 1.3718869333333336e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:33,683] [INFO] [timer.py:215:stop] epoch=0/micro_step=315/global_step=315, RunningAvgSamplesPerSec=5.354281798654154, CurrSamplesPerSec=5.336020233169982, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      315/109863281 | consumed samples:         1260 | consumed tokens:      2580480 | elapsed time per iteration (ms): 875.6 | learning rate: 1.372E-06 | global batch size:     4 | lm loss: 9.015007E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.568 | TFLOPs: 66.50 |
[default0]:[2023-07-30 22:27:38,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=0, lr=[1.3937322666666669e-06, 1.3937322666666669e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:38,157] [INFO] [timer.py:215:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=5.354352053347623, CurrSamplesPerSec=5.361763705766099, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      320/109863281 | consumed samples:         1280 | consumed tokens:      2621440 | elapsed time per iteration (ms): 894.1 | learning rate: 1.394E-06 | global batch size:     4 | lm loss: 9.073343E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.474 | TFLOPs: 65.12 |
[default0]:[2023-07-30 22:27:42,592] [INFO] [logging.py:96:log_dist] [Rank 0] step=325, skipped=0, lr=[1.4155776e-06, 1.4155776e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:42,595] [INFO] [timer.py:215:stop] epoch=0/micro_step=325/global_step=325, RunningAvgSamplesPerSec=5.354492240882836, CurrSamplesPerSec=5.327674941387438, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      325/109863281 | consumed samples:         1300 | consumed tokens:      2662400 | elapsed time per iteration (ms): 887.8 | learning rate: 1.416E-06 | global batch size:     4 | lm loss: 8.964661E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.506 | TFLOPs: 65.59 |
[default0]:[2023-07-30 22:27:47,158] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=0, lr=[1.4374229333333334e-06, 1.4374229333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:47,160] [INFO] [timer.py:215:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=5.354350882226707, CurrSamplesPerSec=5.345982280130708, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      330/109863281 | consumed samples:         1320 | consumed tokens:      2703360 | elapsed time per iteration (ms): 913.2 | learning rate: 1.437E-06 | global batch size:     4 | lm loss: 9.034767E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.380 | TFLOPs: 63.76 |
[default0]:[2023-07-30 22:27:51,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=335, skipped=0, lr=[1.4592682666666666e-06, 1.4592682666666666e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:51,542] [INFO] [timer.py:215:stop] epoch=0/micro_step=335/global_step=335, RunningAvgSamplesPerSec=5.354591938067093, CurrSamplesPerSec=5.373645996049491, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      335/109863281 | consumed samples:         1340 | consumed tokens:      2744320 | elapsed time per iteration (ms): 876.3 | learning rate: 1.459E-06 | global batch size:     4 | lm loss: 8.901855E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.565 | TFLOPs: 66.44 |
[default0]:[2023-07-30 22:27:56,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=0, lr=[1.4811135999999999e-06, 1.4811135999999999e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:27:56,230] [INFO] [timer.py:215:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=5.354221526725864, CurrSamplesPerSec=5.317364646968868, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      340/109863281 | consumed samples:         1360 | consumed tokens:      2785280 | elapsed time per iteration (ms): 937.4 | learning rate: 1.481E-06 | global batch size:     4 | lm loss: 8.967701E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.267 | TFLOPs: 62.11 |
[default0]:[2023-07-30 22:28:00,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=345, skipped=0, lr=[1.5029589333333334e-06, 1.5029589333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:00,772] [INFO] [timer.py:215:stop] epoch=0/micro_step=345/global_step=345, RunningAvgSamplesPerSec=5.354327133816987, CurrSamplesPerSec=5.371213394533067, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      345/109863281 | consumed samples:         1380 | consumed tokens:      2826240 | elapsed time per iteration (ms): 908.6 | learning rate: 1.503E-06 | global batch size:     4 | lm loss: 8.877134E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.402 | TFLOPs: 64.08 |
[default0]:[2023-07-30 22:28:05,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=0, lr=[1.5248042666666666e-06, 1.5248042666666666e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:05,667] [INFO] [timer.py:215:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=5.353941001145841, CurrSamplesPerSec=5.321241939105756, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      350/109863281 | consumed samples:         1400 | consumed tokens:      2867200 | elapsed time per iteration (ms): 978.9 | learning rate: 1.525E-06 | global batch size:     4 | lm loss: 8.953637E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.086 | TFLOPs: 59.48 |
[default0]:[2023-07-30 22:28:10,205] [INFO] [logging.py:96:log_dist] [Rank 0] step=355, skipped=0, lr=[1.5466496e-06, 1.5466496e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:10,206] [INFO] [timer.py:215:stop] epoch=0/micro_step=355/global_step=355, RunningAvgSamplesPerSec=5.354069437883787, CurrSamplesPerSec=5.373313835024062, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      355/109863281 | consumed samples:         1420 | consumed tokens:      2908160 | elapsed time per iteration (ms): 907.7 | learning rate: 1.547E-06 | global batch size:     4 | lm loss: 8.942751E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.407 | TFLOPs: 64.15 |
[default0]:[2023-07-30 22:28:14,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=0, lr=[1.5684949333333333e-06, 1.5684949333333333e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:14,760] [INFO] [timer.py:215:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=5.353925456643238, CurrSamplesPerSec=5.3205568039902555, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      360/109863281 | consumed samples:         1440 | consumed tokens:      2949120 | elapsed time per iteration (ms): 911.0 | learning rate: 1.568E-06 | global batch size:     4 | lm loss: 8.955126E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.391 | TFLOPs: 63.91 |
[default0]:[2023-07-30 22:28:19,110] [INFO] [logging.py:96:log_dist] [Rank 0] step=365, skipped=0, lr=[1.5903402666666668e-06, 1.5903402666666668e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:19,112] [INFO] [timer.py:215:stop] epoch=0/micro_step=365/global_step=365, RunningAvgSamplesPerSec=5.3537664022335, CurrSamplesPerSec=5.364594261617569, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      365/109863281 | consumed samples:         1460 | consumed tokens:      2990080 | elapsed time per iteration (ms): 870.0 | learning rate: 1.590E-06 | global batch size:     4 | lm loss: 8.853207E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.597 | TFLOPs: 66.92 |
[default0]:[2023-07-30 22:28:23,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=0, lr=[1.6121856e-06, 1.6121856e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:23,624] [INFO] [timer.py:215:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=5.35378892497311, CurrSamplesPerSec=5.310337885957555, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      370/109863281 | consumed samples:         1480 | consumed tokens:      3031040 | elapsed time per iteration (ms): 902.6 | learning rate: 1.612E-06 | global batch size:     4 | lm loss: 8.900805E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.432 | TFLOPs: 64.51 |
[default0]:[2023-07-30 22:28:28,020] [INFO] [logging.py:96:log_dist] [Rank 0] step=375, skipped=0, lr=[1.6340309333333335e-06, 1.6340309333333335e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:28,023] [INFO] [timer.py:215:stop] epoch=0/micro_step=375/global_step=375, RunningAvgSamplesPerSec=5.353475946284424, CurrSamplesPerSec=5.326871445517193, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      375/109863281 | consumed samples:         1500 | consumed tokens:      3072000 | elapsed time per iteration (ms): 880.0 | learning rate: 1.634E-06 | global batch size:     4 | lm loss: 8.823701E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.545 | TFLOPs: 66.16 |
[default0]:[2023-07-30 22:28:32,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=0, lr=[1.6558762666666668e-06, 1.6558762666666668e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:32,557] [INFO] [timer.py:215:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=5.353707214316362, CurrSamplesPerSec=5.3665624950019994, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      380/109863281 | consumed samples:         1520 | consumed tokens:      3112960 | elapsed time per iteration (ms): 906.5 | learning rate: 1.656E-06 | global batch size:     4 | lm loss: 8.819386E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.413 | TFLOPs: 64.23 |
[default0]:[2023-07-30 22:28:37,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=385, skipped=0, lr=[1.6777216e-06, 1.6777216e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:37,098] [INFO] [timer.py:215:stop] epoch=0/micro_step=385/global_step=385, RunningAvgSamplesPerSec=5.3534739260238755, CurrSamplesPerSec=5.3373545106857065, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      385/109863281 | consumed samples:         1540 | consumed tokens:      3153920 | elapsed time per iteration (ms): 908.4 | learning rate: 1.678E-06 | global batch size:     4 | lm loss: 9.032915E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.403 | TFLOPs: 64.10 |
[default0]:[2023-07-30 22:28:41,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=0, lr=[1.6995669333333335e-06, 1.6995669333333335e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:41,479] [INFO] [timer.py:215:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=5.35363154508402, CurrSamplesPerSec=5.358626328699918, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      390/109863281 | consumed samples:         1560 | consumed tokens:      3194880 | elapsed time per iteration (ms): 876.2 | learning rate: 1.700E-06 | global batch size:     4 | lm loss: 8.812140E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.565 | TFLOPs: 66.45 |
[default0]:[2023-07-30 22:28:46,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=395, skipped=0, lr=[1.7214122666666668e-06, 1.7214122666666668e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:46,040] [INFO] [timer.py:215:stop] epoch=0/micro_step=395/global_step=395, RunningAvgSamplesPerSec=5.353277401318895, CurrSamplesPerSec=5.3217972642438, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      395/109863281 | consumed samples:         1580 | consumed tokens:      3235840 | elapsed time per iteration (ms): 912.5 | learning rate: 1.721E-06 | global batch size:     4 | lm loss: 8.735431E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.383 | TFLOPs: 63.80 |
[default0]:[2023-07-30 22:28:50,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=0, lr=[1.7432576000000002e-06, 1.7432576000000002e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:28:50,496] [INFO] [timer.py:215:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=5.353362919135693, CurrSamplesPerSec=5.373084960391743, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      400/109863281 | consumed samples:         1600 | consumed tokens:      3276800 | elapsed time per iteration (ms): 890.9 | learning rate: 1.743E-06 | global batch size:     4 | lm loss: 8.818698E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.490 | TFLOPs: 65.35 |
[default0]:-----------------------------------------------------------------------------------------------
[default0]: validation loss at iteration 400 | lm loss value: 8.760621E+00 | lm loss PPL: 6.378072E+03 | 
[default0]:-----------------------------------------------------------------------------------------------
[default0]:[2023-07-30 22:29:08,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=405, skipped=0, lr=[1.7651029333333335e-06, 1.7651029333333335e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:08,956] [INFO] [timer.py:215:stop] epoch=0/micro_step=405/global_step=405, RunningAvgSamplesPerSec=5.3532424352523345, CurrSamplesPerSec=5.371196198687841, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      405/109863281 | consumed samples:         1620 | consumed tokens:      3317760 | elapsed time per iteration (ms): 3692.8 | learning rate: 1.765E-06 | global batch size:     4 | lm loss: 8.752266E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 1.083 | TFLOPs: 15.77 |
[default0]:[2023-07-30 22:29:13,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=0, lr=[1.7869482666666666e-06, 1.7869482666666666e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:13,378] [INFO] [timer.py:215:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=5.353330119418527, CurrSamplesPerSec=5.31010762190191, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      410/109863281 | consumed samples:         1640 | consumed tokens:      3358720 | elapsed time per iteration (ms): 883.3 | learning rate: 1.787E-06 | global batch size:     4 | lm loss: 8.713361E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.528 | TFLOPs: 65.91 |
[default0]:[2023-07-30 22:29:17,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=415, skipped=0, lr=[1.8087936e-06, 1.8087936e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:17,816] [INFO] [timer.py:215:stop] epoch=0/micro_step=415/global_step=415, RunningAvgSamplesPerSec=5.352825463519263, CurrSamplesPerSec=5.337373188515299, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      415/109863281 | consumed samples:         1660 | consumed tokens:      3399680 | elapsed time per iteration (ms): 887.4 | learning rate: 1.809E-06 | global batch size:     4 | lm loss: 8.828268E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.507 | TFLOPs: 65.61 |
[default0]:[2023-07-30 22:29:22,227] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=0, lr=[1.8306389333333333e-06, 1.8306389333333333e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:22,228] [INFO] [timer.py:215:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=5.353079672322206, CurrSamplesPerSec=5.367390030226171, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      420/109863281 | consumed samples:         1680 | consumed tokens:      3440640 | elapsed time per iteration (ms): 882.5 | learning rate: 1.831E-06 | global batch size:     4 | lm loss: 8.753241E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.532 | TFLOPs: 65.97 |
[default0]:[2023-07-30 22:29:26,621] [INFO] [logging.py:96:log_dist] [Rank 0] step=425, skipped=0, lr=[1.8524842666666667e-06, 1.8524842666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:26,623] [INFO] [timer.py:215:stop] epoch=0/micro_step=425/global_step=425, RunningAvgSamplesPerSec=5.352820277009496, CurrSamplesPerSec=5.335855616665516, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      425/109863281 | consumed samples:         1700 | consumed tokens:      3481600 | elapsed time per iteration (ms): 879.2 | learning rate: 1.852E-06 | global batch size:     4 | lm loss: 8.793423E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.550 | TFLOPs: 66.22 |
[default0]:[2023-07-30 22:29:31,032] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=0, lr=[1.8743296e-06, 1.8743296e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:31,034] [INFO] [timer.py:215:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=5.352978970062053, CurrSamplesPerSec=5.362118432991641, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      430/109863281 | consumed samples:         1720 | consumed tokens:      3522560 | elapsed time per iteration (ms): 881.7 | learning rate: 1.874E-06 | global batch size:     4 | lm loss: 8.703077E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.536 | TFLOPs: 66.03 |
[default0]:[2023-07-30 22:29:35,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=435, skipped=0, lr=[1.8961749333333335e-06, 1.8961749333333335e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:35,560] [INFO] [timer.py:215:stop] epoch=0/micro_step=435/global_step=435, RunningAvgSamplesPerSec=5.352942773505638, CurrSamplesPerSec=5.336994563505823, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      435/109863281 | consumed samples:         1740 | consumed tokens:      3563520 | elapsed time per iteration (ms): 905.3 | learning rate: 1.896E-06 | global batch size:     4 | lm loss: 8.742505E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.418 | TFLOPs: 64.31 |
[default0]:[2023-07-30 22:29:39,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=0, lr=[1.9180202666666667e-06, 1.9180202666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:39,999] [INFO] [timer.py:215:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=5.352961733176397, CurrSamplesPerSec=5.3666878107029765, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      440/109863281 | consumed samples:         1760 | consumed tokens:      3604480 | elapsed time per iteration (ms): 887.8 | learning rate: 1.918E-06 | global batch size:     4 | lm loss: 8.724228E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.506 | TFLOPs: 65.58 |
[default0]:[2023-07-30 22:29:44,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=445, skipped=0, lr=[1.9398656e-06, 1.9398656e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:44,512] [INFO] [timer.py:215:stop] epoch=0/micro_step=445/global_step=445, RunningAvgSamplesPerSec=5.352975970098865, CurrSamplesPerSec=5.325843324385617, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      445/109863281 | consumed samples:         1780 | consumed tokens:      3645440 | elapsed time per iteration (ms): 903.1 | learning rate: 1.940E-06 | global batch size:     4 | lm loss: 8.734917E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.429 | TFLOPs: 64.47 |
[default0]:[2023-07-30 22:29:49,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=0, lr=[1.9617109333333333e-06, 1.9617109333333333e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:49,025] [INFO] [timer.py:215:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=5.352964967965581, CurrSamplesPerSec=5.365076319522525, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      450/109863281 | consumed samples:         1800 | consumed tokens:      3686400 | elapsed time per iteration (ms): 901.8 | learning rate: 1.962E-06 | global batch size:     4 | lm loss: 8.695134E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.435 | TFLOPs: 64.56 |
[default0]:[2023-07-30 22:29:53,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=455, skipped=0, lr=[1.983556266666667e-06, 1.983556266666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:53,474] [INFO] [timer.py:215:stop] epoch=0/micro_step=455/global_step=455, RunningAvgSamplesPerSec=5.353060840791148, CurrSamplesPerSec=5.32172636521919, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      455/109863281 | consumed samples:         1820 | consumed tokens:      3727360 | elapsed time per iteration (ms): 890.3 | learning rate: 1.984E-06 | global batch size:     4 | lm loss: 8.866692E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.493 | TFLOPs: 65.40 |
[default0]:[2023-07-30 22:29:58,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=0, lr=[2.0054016e-06, 2.0054016e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:29:58,161] [INFO] [timer.py:215:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=5.352954204204691, CurrSamplesPerSec=5.330489933615174, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      460/109863281 | consumed samples:         1840 | consumed tokens:      3768320 | elapsed time per iteration (ms): 938.0 | learning rate: 2.005E-06 | global batch size:     4 | lm loss: 8.691483E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.265 | TFLOPs: 62.07 |
[default0]:[2023-07-30 22:30:02,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=465, skipped=0, lr=[2.0272469333333334e-06, 2.0272469333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:02,876] [INFO] [timer.py:215:stop] epoch=0/micro_step=465/global_step=465, RunningAvgSamplesPerSec=5.353170627243791, CurrSamplesPerSec=5.361198295635746, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      465/109863281 | consumed samples:         1860 | consumed tokens:      3809280 | elapsed time per iteration (ms): 942.0 | learning rate: 2.027E-06 | global batch size:     4 | lm loss: 8.637433E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.246 | TFLOPs: 61.81 |
[default0]:[2023-07-30 22:30:07,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=0, lr=[2.0490922666666667e-06, 2.0490922666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:07,384] [INFO] [timer.py:215:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=5.353077193916268, CurrSamplesPerSec=5.327612344582875, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      470/109863281 | consumed samples:         1880 | consumed tokens:      3850240 | elapsed time per iteration (ms): 901.7 | learning rate: 2.049E-06 | global batch size:     4 | lm loss: 8.608936E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.436 | TFLOPs: 64.57 |
[default0]:[2023-07-30 22:30:11,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=475, skipped=0, lr=[2.0709376000000004e-06, 2.0709376000000004e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:11,832] [INFO] [timer.py:215:stop] epoch=0/micro_step=475/global_step=475, RunningAvgSamplesPerSec=5.353188009274059, CurrSamplesPerSec=5.366420019876322, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      475/109863281 | consumed samples:         1900 | consumed tokens:      3891200 | elapsed time per iteration (ms): 889.8 | learning rate: 2.071E-06 | global batch size:     4 | lm loss: 8.651493E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.495 | TFLOPs: 65.44 |
[default0]:[2023-07-30 22:30:16,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=0, lr=[2.0927829333333336e-06, 2.0927829333333336e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:16,280] [INFO] [timer.py:215:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=5.3531758146661925, CurrSamplesPerSec=5.346984109682993, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      480/109863281 | consumed samples:         1920 | consumed tokens:      3932160 | elapsed time per iteration (ms): 890.0 | learning rate: 2.093E-06 | global batch size:     4 | lm loss: 8.614619E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.495 | TFLOPs: 65.42 |
[default0]:[2023-07-30 22:30:20,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=485, skipped=0, lr=[2.114628266666667e-06, 2.114628266666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:20,700] [INFO] [timer.py:215:stop] epoch=0/micro_step=485/global_step=485, RunningAvgSamplesPerSec=5.353249718625901, CurrSamplesPerSec=5.366100765739789, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      485/109863281 | consumed samples:         1940 | consumed tokens:      3973120 | elapsed time per iteration (ms): 883.2 | learning rate: 2.115E-06 | global batch size:     4 | lm loss: 8.527265E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.529 | TFLOPs: 65.92 |
[default0]:[2023-07-30 22:30:25,117] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=0, lr=[2.1364736e-06, 2.1364736e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:25,118] [INFO] [timer.py:215:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=5.353294590809511, CurrSamplesPerSec=5.340393924182471, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      490/109863281 | consumed samples:         1960 | consumed tokens:      4014080 | elapsed time per iteration (ms): 884.1 | learning rate: 2.136E-06 | global batch size:     4 | lm loss: 8.578207E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.524 | TFLOPs: 65.85 |
[default0]:[2023-07-30 22:30:29,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=495, skipped=0, lr=[2.1583189333333334e-06, 2.1583189333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:29,533] [INFO] [timer.py:215:stop] epoch=0/micro_step=495/global_step=495, RunningAvgSamplesPerSec=5.353288282712056, CurrSamplesPerSec=5.357052174468357, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      495/109863281 | consumed samples:         1980 | consumed tokens:      4055040 | elapsed time per iteration (ms): 882.7 | learning rate: 2.158E-06 | global batch size:     4 | lm loss: 8.573904E+00 | loss scale: 2048.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.532 | TFLOPs: 65.96 |
[default0]:[2023-07-30 22:30:33,867] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=0, lr=[2.1801642666666667e-06, 2.1801642666666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:33,869] [INFO] [timer.py:215:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=5.353435603963867, CurrSamplesPerSec=5.345515569406214, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      500/109863281 | consumed samples:         2000 | consumed tokens:      4096000 | elapsed time per iteration (ms): 867.1 | learning rate: 2.180E-06 | global batch size:     4 | lm loss: 8.553860E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.613 | TFLOPs: 67.15 |
[default0]:-----------------------------------------------------------------------------------------------
[default0]: validation loss at iteration 500 | lm loss value: 8.585509E+00 | lm loss PPL: 5.353519E+03 | 
[default0]:-----------------------------------------------------------------------------------------------
[default0]:[2023-07-30 22:30:52,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=505, skipped=0, lr=[2.2020096e-06, 2.2020096e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:52,252] [INFO] [timer.py:215:stop] epoch=0/micro_step=505/global_step=505, RunningAvgSamplesPerSec=5.353511808234219, CurrSamplesPerSec=5.366878370450272, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      505/109863281 | consumed samples:         2020 | consumed tokens:      4136960 | elapsed time per iteration (ms): 3676.4 | learning rate: 2.202E-06 | global batch size:     4 | lm loss: 8.478644E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 1.088 | TFLOPs: 15.84 |
[default0]:[2023-07-30 22:30:56,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=0, lr=[2.223854933333333e-06, 2.223854933333333e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:30:56,935] [INFO] [timer.py:215:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=5.353422961135127, CurrSamplesPerSec=5.328140234007051, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      510/109863281 | consumed samples:         2040 | consumed tokens:      4177920 | elapsed time per iteration (ms): 936.7 | learning rate: 2.224E-06 | global batch size:     4 | lm loss: 8.759943E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.270 | TFLOPs: 62.16 |
[default0]:[2023-07-30 22:31:01,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=515, skipped=0, lr=[2.245700266666667e-06, 2.245700266666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:01,324] [INFO] [timer.py:215:stop] epoch=0/micro_step=515/global_step=515, RunningAvgSamplesPerSec=5.353460590839151, CurrSamplesPerSec=5.356463815201344, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      515/109863281 | consumed samples:         2060 | consumed tokens:      4218880 | elapsed time per iteration (ms): 877.7 | learning rate: 2.246E-06 | global batch size:     4 | lm loss: 8.609774E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.557 | TFLOPs: 66.34 |
[default0]:[2023-07-30 22:31:05,994] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=0, lr=[2.2675456e-06, 2.2675456e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:05,996] [INFO] [timer.py:215:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=5.353312761004744, CurrSamplesPerSec=5.308414030080731, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      520/109863281 | consumed samples:         2080 | consumed tokens:      4259840 | elapsed time per iteration (ms): 934.4 | learning rate: 2.268E-06 | global batch size:     4 | lm loss: 8.560973E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.281 | TFLOPs: 62.31 |
[default0]:[2023-07-30 22:31:10,439] [INFO] [logging.py:96:log_dist] [Rank 0] step=525, skipped=0, lr=[2.2893909333333334e-06, 2.2893909333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:10,440] [INFO] [timer.py:215:stop] epoch=0/micro_step=525/global_step=525, RunningAvgSamplesPerSec=5.352385721456277, CurrSamplesPerSec=5.36145871215438, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      525/109863281 | consumed samples:         2100 | consumed tokens:      4300800 | elapsed time per iteration (ms): 888.6 | learning rate: 2.289E-06 | global batch size:     4 | lm loss: 8.372310E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.501 | TFLOPs: 65.52 |
[default0]:[2023-07-30 22:31:15,073] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=0, lr=[2.3112362666666666e-06, 2.3112362666666666e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:15,075] [INFO] [timer.py:215:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=5.3523829086072965, CurrSamplesPerSec=5.315888748312369, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      530/109863281 | consumed samples:         2120 | consumed tokens:      4341760 | elapsed time per iteration (ms): 927.2 | learning rate: 2.311E-06 | global batch size:     4 | lm loss: 8.336813E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.314 | TFLOPs: 62.79 |
[default0]:[2023-07-30 22:31:19,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=535, skipped=0, lr=[2.3330816000000003e-06, 2.3330816000000003e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:19,835] [INFO] [timer.py:215:stop] epoch=0/micro_step=535/global_step=535, RunningAvgSamplesPerSec=5.352404554149543, CurrSamplesPerSec=5.367755806568753, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      535/109863281 | consumed samples:         2140 | consumed tokens:      4382720 | elapsed time per iteration (ms): 951.8 | learning rate: 2.333E-06 | global batch size:     4 | lm loss: 8.524258E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.203 | TFLOPs: 61.17 |
[default0]:[2023-07-30 22:31:24,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=0, lr=[2.3549269333333336e-06, 2.3549269333333336e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:24,202] [INFO] [timer.py:215:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=5.352551510846059, CurrSamplesPerSec=5.344095498715834, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      540/109863281 | consumed samples:         2160 | consumed tokens:      4423680 | elapsed time per iteration (ms): 873.9 | learning rate: 2.355E-06 | global batch size:     4 | lm loss: 8.433018E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.577 | TFLOPs: 66.63 |
[default0]:[2023-07-30 22:31:28,515] [INFO] [logging.py:96:log_dist] [Rank 0] step=545, skipped=0, lr=[2.376772266666667e-06, 2.376772266666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:28,517] [INFO] [timer.py:215:stop] epoch=0/micro_step=545/global_step=545, RunningAvgSamplesPerSec=5.352437640179451, CurrSamplesPerSec=5.332226453185422, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      545/109863281 | consumed samples:         2180 | consumed tokens:      4464640 | elapsed time per iteration (ms): 862.7 | learning rate: 2.377E-06 | global batch size:     4 | lm loss: 8.511518E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.637 | TFLOPs: 67.49 |
[default0]:[2023-07-30 22:31:33,020] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=0, lr=[2.3986176e-06, 2.3986176e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:33,023] [INFO] [timer.py:215:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=5.352530815091886, CurrSamplesPerSec=5.340660823858825, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      550/109863281 | consumed samples:         2200 | consumed tokens:      4505600 | elapsed time per iteration (ms): 901.4 | learning rate: 2.399E-06 | global batch size:     4 | lm loss: 8.300128E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.437 | TFLOPs: 64.59 |
[default0]:[2023-07-30 22:31:37,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=555, skipped=0, lr=[2.4204629333333334e-06, 2.4204629333333334e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:37,586] [INFO] [timer.py:215:stop] epoch=0/micro_step=555/global_step=555, RunningAvgSamplesPerSec=5.352423150122634, CurrSamplesPerSec=5.314139286494842, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      555/109863281 | consumed samples:         2220 | consumed tokens:      4546560 | elapsed time per iteration (ms): 912.7 | learning rate: 2.420E-06 | global batch size:     4 | lm loss: 8.427208E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.383 | TFLOPs: 63.80 |
[default0]:[2023-07-30 22:31:41,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=0, lr=[2.442308266666667e-06, 2.442308266666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:41,943] [INFO] [timer.py:215:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=5.35240555914447, CurrSamplesPerSec=5.34850119883053, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      560/109863281 | consumed samples:         2240 | consumed tokens:      4587520 | elapsed time per iteration (ms): 871.6 | learning rate: 2.442E-06 | global batch size:     4 | lm loss: 8.394138E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.589 | TFLOPs: 66.80 |
[default0]:[2023-07-30 22:31:46,593] [INFO] [logging.py:96:log_dist] [Rank 0] step=565, skipped=0, lr=[2.4641536000000003e-06, 2.4641536000000003e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:46,595] [INFO] [timer.py:215:stop] epoch=0/micro_step=565/global_step=565, RunningAvgSamplesPerSec=5.352314674793474, CurrSamplesPerSec=5.328845941893236, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      565/109863281 | consumed samples:         2260 | consumed tokens:      4628480 | elapsed time per iteration (ms): 929.9 | learning rate: 2.464E-06 | global batch size:     4 | lm loss: 8.437779E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.301 | TFLOPs: 62.61 |
[default0]:[2023-07-30 22:31:50,985] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=0, lr=[2.4859989333333336e-06, 2.4859989333333336e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:50,986] [INFO] [timer.py:215:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=5.352239591278691, CurrSamplesPerSec=5.368585427791744, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      570/109863281 | consumed samples:         2280 | consumed tokens:      4669440 | elapsed time per iteration (ms): 878.2 | learning rate: 2.486E-06 | global batch size:     4 | lm loss: 8.327805E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.555 | TFLOPs: 66.30 |
[default0]:[2023-07-30 22:31:55,527] [INFO] [logging.py:96:log_dist] [Rank 0] step=575, skipped=0, lr=[2.507844266666667e-06, 2.507844266666667e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:55,529] [INFO] [timer.py:215:stop] epoch=0/micro_step=575/global_step=575, RunningAvgSamplesPerSec=5.352188046465533, CurrSamplesPerSec=5.3126062974647565, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      575/109863281 | consumed samples:         2300 | consumed tokens:      4710400 | elapsed time per iteration (ms): 908.5 | learning rate: 2.508E-06 | global batch size:     4 | lm loss: 8.477991E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.403 | TFLOPs: 64.09 |
[default0]:[2023-07-30 22:31:59,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=0, lr=[2.5296896e-06, 2.5296896e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:31:59,942] [INFO] [timer.py:215:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=5.352204007357113, CurrSamplesPerSec=5.3759292079634635, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      580/109863281 | consumed samples:         2320 | consumed tokens:      4751360 | elapsed time per iteration (ms): 882.6 | learning rate: 2.530E-06 | global batch size:     4 | lm loss: 8.413788E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.532 | TFLOPs: 65.97 |
[default0]:[2023-07-30 22:32:04,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=585, skipped=0, lr=[2.5515349333333333e-06, 2.5515349333333333e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:32:04,324] [INFO] [timer.py:215:stop] epoch=0/micro_step=585/global_step=585, RunningAvgSamplesPerSec=5.352328548910787, CurrSamplesPerSec=5.347026712798534, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      585/109863281 | consumed samples:         2340 | consumed tokens:      4792320 | elapsed time per iteration (ms): 876.6 | learning rate: 2.552E-06 | global batch size:     4 | lm loss: 8.297141E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.563 | TFLOPs: 66.42 |
[default0]:[2023-07-30 22:32:08,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=0, lr=[2.5733802666666666e-06, 2.5733802666666666e-06], mom=[(0.9, 0.95), (0.9, 0.95)]
[default0]:[2023-07-30 22:32:08,972] [INFO] [timer.py:215:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=5.35216296426625, CurrSamplesPerSec=5.311777068438313, MemAllocated=10.41GB, MaxMemAllocated=16.08GB
[default0]: iteration      590/109863281 | consumed samples:         2360 | consumed tokens:      4833280 | elapsed time per iteration (ms): 929.4 | learning rate: 2.573E-06 | global batch size:     4 | lm loss: 8.222729E+00 | loss scale: 4096.0 | actual seqlen:  2048 | number of skipped iterations:   0 | number of nan iterations:   0 | samples per second: 4.304 | TFLOPs: 62.65 |
slurmstepd: error: *** JOB 4505004 ON n2gpu1225 CANCELLED AT 2023-07-30T22:32:10 DUE TO TIME LIMIT ***
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 4505004.0 ON n2gpu1225 CANCELLED AT 2023-07-30T22:32:10 DUE TO TIME LIMIT ***
WARNING:torch.distributed.elastic.agent.server.api:Received 15 death signal, shutting down workers
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 413786 closing signal SIGTERM
