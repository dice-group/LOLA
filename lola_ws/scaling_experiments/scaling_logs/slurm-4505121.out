cpu-bind=MASK - n2gpu1207, task  0  0 [436415]: mask |--------|--------||--------|--------||--------|--------||--------|--------||||B-------|--------||--------|--------||--------|--------||--------|--------|  set
Total estimated parameters in the Dense GPT-2 model: 12853386240 (12.85B)
Total Estimated Parameters in the Sparse(MoE) GPT-2 model: 549789834240 (549.79B)
LAUNCHER: python -u -m torch.distributed.run --nproc_per_node 4 --nnodes 4 --rdzv_id=10516 --rdzv_endpoint n2gpu1207:6148 --rdzv_backend c10d --max_restarts 0 --tee 3
CMD: /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py --override-opt_param-scheduler --adam-beta1 0.9 --adam-beta2 0.95 --tensor-model-parallel-size 1 --moe-expert-parallel-size 16 --num-experts 128 --moe-loss-coeff 0.01 --moe-train-capacity-factor 1.0 --moe-eval-capacity-factor 1.0 --moe-min-capacity 4 --init-method-std 0.01 --lr-decay-tokens 300000000000 --lr-warmup-tokens 375000000 --micro-batch-size 32 --exit-duration-in-mins 30000000 --global-batch-size 512 --num-layers 40 --hidden-size 5120 --num-attention-heads 40 --seq-length 2048 --max-position-embeddings 2048 --train-tokens 300000000000 --train-iters 858306 --lr 2.0e-4 --min-lr 2e-06 --lr-decay-style cosine --split 98,2,0 --log-interval 5 --eval-interval 100 --eval-iters 50 --save-interval 1000000 --weight-decay 0.1 --clip-grad 1.0 --hysteresis 2 --num-workers 0 --fp16 --load /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_13B_MoE128_32BATCH_16GPU_4Node/checkpoint/gpt-13B-lr-2.0e-4-minlr-2e-06-bs-512-gpus-16-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true --save /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_13B_MoE128_32BATCH_16GPU_4Node/checkpoint/gpt-13B-lr-2.0e-4-minlr-2e-06-bs-512-gpus-16-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true --tensorboard-queue-size 1 --log-timers-to-tensorboard --log-batch-size-to-tensorboard --log-validation-ppl-to-tensorboard --tensorboard-dir /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_13B_MoE128_32BATCH_16GPU_4Node/tensorboard/gpt-13B-lr-2.0e-4-minlr-2e-06-bs-512-gpus-16-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true_n2gpu1207_2023.07.31-05.16.23 --checkpoint-activations --create-moe-param-group --vocab-file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/gpt2-vocab.json --merge-file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/gpt2-merges.txt --data-path /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/meg-gpt2-oscar-en-10k_text_document --data-impl mmap --deepspeed --deepspeed_config /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_13B_MoE128_32BATCH_16GPU_4Node/ds_config_gpt_gpt-13B-lr-2.0e-4-minlr-2e-06-bs-512-gpus-16-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true.json --pipeline-model-parallel-size 1 --no-pipeline-parallel --deepspeed-activation-checkpointing
cpu-bind=MASK - n2gpu1223, task  2  0 [1438898]: mask |--------|--------||--------|--------||--------|--------||--------|--------||||B-------|--------||--------|--------||--------|--------||--------|--------|  set
cpu-bind=MASK - n2gpu1222, task  1  0 [1222619]: mask |--------|--------||--------|--------||--------|--------||--------|--------||||B-------|--------||--------|--------||--------|--------||--------|--------|  set
cpu-bind=MASK - n2gpu1207, task  0  0 [436536]: mask |--------|--------||--------|--------||--------|--------||--------|--------||||B-------|--------||--------|--------||--------|--------||--------|--------|  set
cpu-bind=MASK - n2gpu1224, task  3  0 [2602533]: mask |--------|--------||--------|--------||--------|--------||--------|--------||||B-------|--------||--------|--------||--------|--------||--------|--------|  set
WARNING:__main__:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
WARNING:__main__:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
WARNING:__main__:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
WARNING:__main__:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[default1]:[2023-07-31 05:16:30,831] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default3]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default1]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default2]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default0]:[2023-07-31 05:16:30,833] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default2]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default0]:[2023-07-31 05:16:30,833] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default0]:[2023-07-31 05:16:30,831] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default2]:[2023-07-31 05:16:30,833] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default3]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default2]:[2023-07-31 05:16:30,833] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default0]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default3]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default1]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default3]:[2023-07-31 05:16:30,832] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default1]:[2023-07-31 05:16:30,833] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[default0]:--------------------------------------------------
[default0]:DeepSpeed C++/CUDA extension op report
[default0]:--------------------------------------------------
[default0]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default0]:      runtime if needed. Op compatibility means that your system
[default0]:      meet the required dependencies to JIT install the op.
[default0]:--------------------------------------------------
[default0]:JIT compiled ops requires ninja
[default2]:--------------------------------------------------
[default2]:DeepSpeed C++/CUDA extension op report
[default2]:--------------------------------------------------
[default2]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default2]:      runtime if needed. Op compatibility means that your system
[default2]:      meet the required dependencies to JIT install the op.
[default2]:--------------------------------------------------
[default2]:JIT compiled ops requires ninja
[default3]:--------------------------------------------------
[default3]:DeepSpeed C++/CUDA extension op report
[default3]:--------------------------------------------------
[default3]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default3]:      runtime if needed. Op compatibility means that your system
[default3]:      meet the required dependencies to JIT install the op.
[default3]:--------------------------------------------------
[default3]:JIT compiled ops requires ninja
[default2]:--------------------------------------------------
[default2]:DeepSpeed C++/CUDA extension op report
[default2]:--------------------------------------------------
[default2]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default2]:      runtime if needed. Op compatibility means that your system
[default2]:      meet the required dependencies to JIT install the op.
[default2]:--------------------------------------------------
[default2]:JIT compiled ops requires ninja
[default0]:--------------------------------------------------
[default0]:DeepSpeed C++/CUDA extension op report
[default0]:--------------------------------------------------
[default0]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default0]:      runtime if needed. Op compatibility means that your system
[default0]:      meet the required dependencies to JIT install the op.
[default0]:--------------------------------------------------
[default0]:JIT compiled ops requires ninja
[default1]:--------------------------------------------------
[default1]:DeepSpeed C++/CUDA extension op report
[default1]:--------------------------------------------------
[default1]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default1]:      runtime if needed. Op compatibility means that your system
[default1]:      meet the required dependencies to JIT install the op.
[default1]:--------------------------------------------------
[default1]:JIT compiled ops requires ninja
[default0]:--------------------------------------------------
[default0]:DeepSpeed C++/CUDA extension op report
[default0]:--------------------------------------------------
[default0]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default0]:      runtime if needed. Op compatibility means that your system
[default0]:      meet the required dependencies to JIT install the op.
[default0]:--------------------------------------------------
[default0]:JIT compiled ops requires ninja
[default2]:--------------------------------------------------
[default2]:DeepSpeed C++/CUDA extension op report
[default2]:--------------------------------------------------
[default2]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default2]:      runtime if needed. Op compatibility means that your system
[default2]:      meet the required dependencies to JIT install the op.
[default2]:--------------------------------------------------
[default2]:JIT compiled ops requires ninja
[default3]:--------------------------------------------------
[default3]:DeepSpeed C++/CUDA extension op report
[default3]:--------------------------------------------------
[default3]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default3]:      runtime if needed. Op compatibility means that your system
[default3]:      meet the required dependencies to JIT install the op.
[default3]:--------------------------------------------------
[default3]:JIT compiled ops requires ninja
[default1]:--------------------------------------------------
[default1]:DeepSpeed C++/CUDA extension op report
[default1]:--------------------------------------------------
[default1]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default1]:      runtime if needed. Op compatibility means that your system
[default1]:      meet the required dependencies to JIT install the op.
[default1]:--------------------------------------------------
[default1]:JIT compiled ops requires ninja
[default3]:--------------------------------------------------
[default3]:DeepSpeed C++/CUDA extension op report
[default3]:--------------------------------------------------
[default3]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default3]:      runtime if needed. Op compatibility means that your system
[default3]:      meet the required dependencies to JIT install the op.
[default3]:--------------------------------------------------
[default3]:JIT compiled ops requires ninja
[default3]:ninja .................. [92m[OKAY][0m
[default3]:--------------------------------------------------
[default3]:op name ................ installed .. compatible
[default3]:--------------------------------------------------
[default1]:--------------------------------------------------
[default1]:DeepSpeed C++/CUDA extension op report
[default1]:--------------------------------------------------
[default1]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default1]:      runtime if needed. Op compatibility means that your system
[default1]:      meet the required dependencies to JIT install the op.
[default1]:--------------------------------------------------
[default1]:JIT compiled ops requires ninja
[default1]:ninja .................. [92m[OKAY][0m
[default1]:--------------------------------------------------
[default1]:op name ................ installed .. compatible
[default1]:--------------------------------------------------
[default3]:--------------------------------------------------
[default3]:DeepSpeed C++/CUDA extension op report
[default3]:--------------------------------------------------
[default3]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default3]:      runtime if needed. Op compatibility means that your system
[default3]:      meet the required dependencies to JIT install the op.
[default3]:--------------------------------------------------
[default3]:JIT compiled ops requires ninja
[default3]:ninja .................. [92m[OKAY][0m
[default3]:--------------------------------------------------
[default3]:op name ................ installed .. compatible
[default3]:--------------------------------------------------
[default1]:--------------------------------------------------
[default1]:DeepSpeed C++/CUDA extension op report
[default1]:--------------------------------------------------
[default1]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default1]:      runtime if needed. Op compatibility means that your system
[default1]:      meet the required dependencies to JIT install the op.
[default1]:--------------------------------------------------
[default1]:JIT compiled ops requires ninja
[default1]:ninja .................. [92m[OKAY][0m
[default1]:--------------------------------------------------
[default1]:op name ................ installed .. compatible
[default1]:--------------------------------------------------
[default0]:--------------------------------------------------
[default0]:DeepSpeed C++/CUDA extension op report
[default0]:--------------------------------------------------
[default0]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default0]:      runtime if needed. Op compatibility means that your system
[default0]:      meet the required dependencies to JIT install the op.
[default0]:--------------------------------------------------
[default0]:JIT compiled ops requires ninja
[default0]:ninja .................. [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:op name ................ installed .. compatible
[default0]:--------------------------------------------------
[default2]:--------------------------------------------------
[default2]:DeepSpeed C++/CUDA extension op report
[default2]:--------------------------------------------------
[default2]:NOTE: Ops not installed will be just-in-time (JIT) compiled at
[default2]:      runtime if needed. Op compatibility means that your system
[default2]:      meet the required dependencies to JIT install the op.
[default2]:--------------------------------------------------
[default2]:JIT compiled ops requires ninja
[default2]:ninja .................. [92m[OKAY][0m
[default2]:--------------------------------------------------
[default2]:op name ................ installed .. compatible
[default2]:--------------------------------------------------
[default3]:ninja .................. [92m[OKAY][0m
[default3]:--------------------------------------------------
[default3]:op name ................ installed .. compatible
[default3]:--------------------------------------------------
[default2]:ninja .................. [92m[OKAY][0m
[default2]:--------------------------------------------------
[default2]:op name ................ installed .. compatible
[default2]:--------------------------------------------------
[default0]:ninja .................. [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:op name ................ installed .. compatible
[default0]:--------------------------------------------------
[default0]:ninja .................. [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:op name ................ installed .. compatible
[default0]:--------------------------------------------------
[default2]:ninja .................. [92m[OKAY][0m
[default2]:--------------------------------------------------
[default2]:op name ................ installed .. compatible
[default2]:--------------------------------------------------
[default1]:ninja .................. [92m[OKAY][0m
[default1]:--------------------------------------------------
[default1]:op name ................ installed .. compatible
[default1]:--------------------------------------------------
[default3]:ninja .................. [92m[OKAY][0m
[default3]:--------------------------------------------------
[default3]:op name ................ installed .. compatible
[default3]:--------------------------------------------------
[default1]:ninja .................. [92m[OKAY][0m
[default1]:--------------------------------------------------
[default1]:op name ................ installed .. compatible
[default1]:--------------------------------------------------
[default0]:ninja .................. [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:op name ................ installed .. compatible
[default0]:--------------------------------------------------
[default2]:ninja .................. [92m[OKAY][0m
[default2]:--------------------------------------------------
[default2]:op name ................ installed .. compatible
[default2]:--------------------------------------------------
[default3]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default0]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default1]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default1]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default1]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default1]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default1]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default1]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default1]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default3]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default0]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default0]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default0]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default0]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default0]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default0]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default2]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default2]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default2]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default2]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default2]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default2]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default2]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default2]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default2]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default2]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default2]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default2]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:--------------------------------------------------
[default2]:DeepSpeed general environment info:
[default2]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default2]:torch version .................... 1.12.0
[default2]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default2]:deepspeed info ................... 0.10.0, unknown, unknown
[default2]:torch cuda version ............... 11.7
[default2]:torch hip version ................ None
[default2]:nvcc version ..................... 11.7
[default2]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default3]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default3]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default3]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default3]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default3]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default3]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default3]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default0]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default0]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default0]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default0]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default0]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default3]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default3]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default3]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default3]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default3]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:--------------------------------------------------
[default3]:DeepSpeed general environment info:
[default3]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default3]:torch version .................... 1.12.0
[default3]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default3]:deepspeed info ................... 0.10.0, unknown, unknown
[default3]:torch cuda version ............... 11.7
[default3]:torch hip version ................ None
[default0]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default0]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:DeepSpeed general environment info:
[default0]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default0]:torch version .................... 1.12.0
[default0]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default0]:deepspeed info ................... 0.10.0, unknown, unknown
[default0]:torch cuda version ............... 11.7
[default0]:torch hip version ................ None
[default3]:nvcc version ..................... 11.7
[default3]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default2]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default2]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default2]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default2]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default2]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default2]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default2]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:nvcc version ..................... 11.7
[default0]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default2]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default2]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default2]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default2]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default2]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default2]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default2]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:--------------------------------------------------
[default0]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default0]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default0]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default0]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default0]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default0]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default0]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:DeepSpeed general environment info:
[default0]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default0]:torch version .................... 1.12.0
[default0]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default0]:deepspeed info ................... 0.10.0, unknown, unknown
[default0]:torch cuda version ............... 11.7
[default0]:torch hip version ................ None
[default0]:nvcc version ..................... 11.7
[default0]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default1]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default1]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default1]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default1]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default1]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default1]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default3]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default3]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default3]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default3]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default3]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default3]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default3]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default3]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default1]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default1]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default3]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default3]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default3]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:--------------------------------------------------
[default3]:DeepSpeed general environment info:
[default3]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default3]:torch version .................... 1.12.0
[default3]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default3]:deepspeed info ................... 0.10.0, unknown, unknown
[default3]:torch cuda version ............... 11.7
[default3]:torch hip version ................ None
[default3]:nvcc version ..................... 11.7
[default3]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default1]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default1]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default1]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default1]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default1]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default1]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default1]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default1]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default1]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default1]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:--------------------------------------------------
[default0]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default0]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default0]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default0]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default0]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default0]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default3]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default3]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default3]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default3]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default3]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default3]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default3]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default0]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:DeepSpeed general environment info:
[default0]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default0]:torch version .................... 1.12.0
[default0]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default0]:deepspeed info ................... 0.10.0, unknown, unknown
[default0]:torch cuda version ............... 11.7
[default0]:torch hip version ................ None
[default0]:nvcc version ..................... 11.7
[default0]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default3]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default3]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default3]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default3]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default3]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:--------------------------------------------------
[default3]:DeepSpeed general environment info:
[default3]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default3]:torch version .................... 1.12.0
[default3]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default3]:deepspeed info ................... 0.10.0, unknown, unknown
[default3]:torch cuda version ............... 11.7
[default3]:torch hip version ................ None
[default2]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default2]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default2]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default2]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default2]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default2]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default2]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default3]:nvcc version ..................... 11.7
[default3]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default1]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default1]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default1]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:--------------------------------------------------
[default1]:DeepSpeed general environment info:
[default1]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default1]:torch version .................... 1.12.0
[default1]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default1]:deepspeed info ................... 0.10.0, unknown, unknown
[default1]:torch cuda version ............... 11.7
[default2]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default2]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default2]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default2]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default2]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:--------------------------------------------------
[default2]:DeepSpeed general environment info:
[default2]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default2]:torch version .................... 1.12.0
[default2]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default2]:deepspeed info ................... 0.10.0, unknown, unknown
[default2]:torch cuda version ............... 11.7
[default2]:torch hip version ................ None
[default1]:torch hip version ................ None
[default1]:nvcc version ..................... 11.7
[default1]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default2]:nvcc version ..................... 11.7
[default2]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default3]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default3]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default3]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default3]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default3]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default3]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default3]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default3]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default3]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default3]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default3]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default3]:--------------------------------------------------
[default3]:DeepSpeed general environment info:
[default3]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default3]:torch version .................... 1.12.0
[default3]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default3]:deepspeed info ................... 0.10.0, unknown, unknown
[default3]:torch cuda version ............... 11.7
[default3]:torch hip version ................ None
[default3]:nvcc version ..................... 11.7
[default3]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default1]:[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[default1]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default1]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default1]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default1]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default1]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default1]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default1]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default1]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default1]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default1]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:--------------------------------------------------
[default1]:DeepSpeed general environment info:
[default1]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default1]:torch version .................... 1.12.0
[default1]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default1]:deepspeed info ................... 0.10.0, unknown, unknown
[default1]:torch cuda version ............... 11.7
[default1]:torch hip version ................ None
[default1]:nvcc version ..................... 11.7
[default1]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default0]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default0]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default0]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default0]:--------------------------------------------------
[default0]:DeepSpeed general environment info:
[default0]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default0]:torch version .................... 1.12.0
[default0]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default0]:deepspeed info ................... 0.10.0, unknown, unknown
[default0]:torch cuda version ............... 11.7
[default0]:torch hip version ................ None
[default0]:nvcc version ..................... 11.7
[default0]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default2]:DeepSpeed general environment info:
[default2]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default2]:torch version .................... 1.12.0
[default2]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default2]:deepspeed info ................... 0.10.0, unknown, unknown
[default2]:torch cuda version ............... 11.7
[default2]:torch hip version ................ None
[default2]:nvcc version ..................... 11.7
[default2]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default2]:[93m [WARNING] [0m async_io: please install the libaio-devel package with yum
[default2]:[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[default2]:async_io ............... [93m[NO][0m ....... [93m[NO][0m
[default2]:cpu_adagrad ............ [93m[NO][0m ....... [92m[OKAY][0m
[default2]:cpu_adam ............... [93m[NO][0m ....... [92m[OKAY][0m
[default2]:fused_adam ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:fused_lamb ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:quantizer .............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:random_ltd ............. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[default2]:sparse_attn ............ [93m[NO][0m ....... [93m[NO][0m
[default2]:spatial_inference ...... [93m[NO][0m ....... [92m[OKAY][0m
[default2]:transformer ............ [93m[NO][0m ....... [92m[OKAY][0m
[default2]:stochastic_transformer . [93m[NO][0m ....... [92m[OKAY][0m
[default2]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default2]:--------------------------------------------------
[default2]:DeepSpeed general environment info:
[default2]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default2]:torch version .................... 1.12.0
[default2]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default2]:deepspeed info ................... 0.10.0, unknown, unknown
[default2]:torch cuda version ............... 11.7
[default2]:torch hip version ................ None
[default2]:nvcc version ..................... 11.7
[default2]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default1]:transformer_inference .. [93m[NO][0m ....... [92m[OKAY][0m
[default1]:--------------------------------------------------
[default1]:DeepSpeed general environment info:
[default1]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default1]:torch version .................... 1.12.0
[default1]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default1]:deepspeed info ................... 0.10.0, unknown, unknown
[default1]:torch cuda version ............... 11.7
[default1]:torch hip version ................ None
[default1]:nvcc version ..................... 11.7
[default1]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default1]:DeepSpeed general environment info:
[default1]:torch install path ............... ['/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch']
[default1]:torch version .................... 1.12.0
[default1]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/lib/python3.10/site-packages/deepspeed']
[default1]:deepspeed info ................... 0.10.0, unknown, unknown
[default1]:torch cuda version ............... 11.7
[default1]:torch hip version ................ None
[default1]:nvcc version ..................... 11.7
[default1]:deepspeed wheel compiled w. ...... torch 1.12, cuda 11.7
[default3]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default0]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default0]:using world size: 16, data-parallel-size: 16, tensor-model-parallel size: 1, pipeline-model-parallel size: 1 
[default0]:using torch.float16 for parameters ...
[default0]:------------------------ arguments ------------------------
[default0]:  accumulate_allreduce_grads_in_fp32 .............. False
[default0]:  adam_beta1 ...................................... 0.9
[default0]:  adam_beta2 ...................................... 0.95
[default0]:  adam_eps ........................................ 1e-08
[default0]:  add_bias_linear ................................. True
[default0]:  add_position_embedding .......................... True
[default0]:  adlr_autoresume ................................. False
[default0]:  adlr_autoresume_interval ........................ 1000
[default0]:  aml_data_download_path .......................... None
[default0]:  apply_layernorm_1p .............................. False
[default0]:  apply_query_key_layer_scaling ................... True
[default0]:  apply_residual_connection_post_layernorm ........ False
[default0]:  async_tensor_model_parallel_allreduce ........... False
[default0]:  attention_dropout ............................... 0.1
[default0]:  attention_softmax_in_fp32 ....................... False
[default0]:  barrier_with_L1_time ............................ True
[default0]:  bert_binary_head ................................ True
[default0]:  bert_embedder_type .............................. megatron
[default0]:  bert_load ....................................... None
[default0]:  bf16 ............................................ False
[default0]:  bias_dropout_fusion ............................. True
[default0]:  bias_gelu_fusion ................................ True
[default0]:  biencoder_projection_dim ........................ 0
[default0]:  biencoder_shared_query_context_model ............ False
[default0]:  block_data_path ................................. None
[default0]:  checkpoint_activations .......................... True
[default0]:  checkpoint_in_cpu ............................... False
[default0]:  checkpoint_num_layers ........................... 1
[default0]:  classes_fraction ................................ 1.0
[default0]:  clip_grad ....................................... 1.0
[default0]:  compression_training ............................ False
[default0]:  consumed_train_samples .......................... 0
[default0]:  consumed_train_tokens ........................... 0
[default0]:  consumed_valid_samples .......................... 0
[default0]:  contigious_checkpointing ........................ False
[default0]:  cpu_optimizer ................................... False
[default0]:  cpu_torch_adam .................................. False
[default0]:  create_moe_param_group .......................... True
[default0]:  curriculum_learning_legacy ...................... False
[default0]:  data_cache_path ................................. None
[default0]:  data_efficiency_curriculum_learning ............. False
[default0]:  data_impl ....................................... mmap
[default0]:  data_parallel_random_init ....................... False
[default0]:  data_parallel_size .............................. 16
[default0]:  data_path ....................................... ['/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/meg-gpt2-oscar-en-10k_text_document']
[default0]:  data_per_class_fraction ......................... 1.0
[default0]:  data_sharding ................................... True
[default0]:  dataloader_type ................................. single
[default0]:  DDP_impl ........................................ local
[default0]:  decoder_num_layers .............................. None
[default0]:  decoder_seq_length .............................. None
[default0]:  deepscale ....................................... False
[default0]:  deepscale_config ................................ None
[default0]:  deepspeed ....................................... True
[default0]:  deepspeed_activation_checkpointing .............. True
[default0]:  deepspeed_config ................................ /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_13B_MoE128_32BATCH_16GPU_4Node/ds_config_gpt_gpt-13B-lr-2.0e-4-minlr-2e-06-bs-512-gpus-16-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true.json
[default0]:  deepspeed_mpi ................................... False
[default0]:  dino_bottleneck_size ............................ 256
[default0]:  dino_freeze_last_layer .......................... 1
[default0]:  dino_head_hidden_size ........................... 2048
[default0]:  dino_local_crops_number ......................... 10
[default0]:  dino_local_img_size ............................. 96
[default0]:  dino_norm_last_layer ............................ False
[default0]:  dino_teacher_temp ............................... 0.07
[default0]:  dino_warmup_teacher_temp ........................ 0.04
[default0]:  dino_warmup_teacher_temp_epochs ................. 30
[default0]:  distribute_checkpointed_activations ............. False
[default0]:  distribute_saved_activations .................... False
[default0]:  distributed_backend ............................. nccl
[default0]:  distributed_timeout_minutes ..................... 10
[default0]:  ds_inference .................................... False
[default0]:  ds_pipeline_enabled ............................. False
[default0]:  embedding_path .................................. None
[default0]:  embedding_weights_in_fp32 ....................... False
[default0]:  empty_unused_memory_level ....................... 0
[default0]:  enable_expert_tensor_parallelism ................ False
[default0]:  encoder_num_layers .............................. 40
[default0]:  encoder_seq_length .............................. 2048
[default0]:  end_weight_decay ................................ 0.1
[default0]:  eod_mask_loss ................................... False
[default0]:  eval_interval ................................... 100
[default0]:  eval_iters ...................................... 50
[default0]:  evidence_data_path .............................. None
[default0]:  exit_duration_in_mins ........................... 30000000
[default0]:  exit_interval ................................... None
[default0]:  exit_on_missing_checkpoint ...................... False
[default0]:  exit_signal_handler ............................. False
[default0]:  expert_interval ................................. 2
[default0]:  ffn_hidden_size ................................. 20480
[default0]:  finetune ........................................ False
[default0]:  fp16 ............................................ True
[default0]:  fp16_lm_cross_entropy ........................... False
[default0]:  fp32_residual_connection ........................ False
[default0]:  fp8_amax_compute_algo ........................... most_recent
[default0]:  fp8_amax_history_len ............................ 1
[default0]:  fp8_e4m3 ........................................ False
[default0]:  fp8_hybrid ...................................... False
[default0]:  fp8_interval .................................... 1
[default0]:  fp8_margin ...................................... 0
[default0]:  fp8_wgrad ....................................... True
[default0]:  global_batch_size ............................... 512
[default0]:  gradient_accumulation_fusion .................... True
[default0]:  head_lr_mult .................................... 1.0
[default0]:  hidden_dropout .................................. 0.1
[default0]:  hidden_size ..................................... 5120
[default0]:  hidden_size_teacher ............................. None
[default0]:  hysteresis ...................................... 2
[default0]:  ict_head_size ................................... None
[default0]:  ict_load ........................................ None
[default0]:  img_h ........................................... 224
[default0]:  img_w ........................................... 224
[default0]:  indexer_batch_size .............................. 128
[default0]:  indexer_log_interval ............................ 1000
[default0]:  inference ....................................... False
[default0]:  inference_batch_times_seqlen_threshold .......... 512
[default0]:  init_method_std ................................. 0.01
[default0]:  init_method_xavier_uniform ...................... False
[default0]:  initial_loss_scale .............................. 4294967296
[default0]:  iter_per_epoch .................................. 1250
[default0]:  kd .............................................. False
[default0]:  kd_alpha_ce ..................................... 1
[default0]:  kd_beta_ce ...................................... 1
[default0]:  kd_temp ......................................... 1.0
[default0]:  kv_channels ..................................... 128
[default0]:  layernorm_epsilon ............................... 1e-05
[default0]:  lazy_mpu_init ................................... None
[default0]:  load ............................................ /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_13B_MoE128_32BATCH_16GPU_4Node/checkpoint/gpt-13B-lr-2.0e-4-minlr-2e-06-bs-512-gpus-16-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true
[default0]:  load_teacher .................................... None
[default0]:  local_rank ...................................... None
[default0]:  log_batch_size_to_tensorboard ................... True
[default0]:  log_interval .................................... 5
[default0]:  log_learning_rate_to_tensorboard ................ True
[default0]:  log_loss_scale_to_tensorboard ................... True
[default0]:  log_memory_to_tensorboard ....................... False
[default0]:  log_num_zeros_in_grad ........................... False
[default0]:  log_optimizer_states_to_tensorboard ............. False
[default0]:  log_params_norm ................................. False
[default0]:  log_timers_to_tensorboard ....................... True
[default0]:  log_validation_ppl_to_tensorboard ............... True
[default0]:  log_world_size_to_tensorboard ................... False
[default0]:  loss_scale ...................................... None
[default0]:  loss_scale_window ............................... 1000
[default0]:  lr .............................................. 0.0002
[default0]:  lr_decay_iters .................................. None
[default0]:  lr_decay_samples ................................ None
[default0]:  lr_decay_style .................................. cosine
[default0]:  lr_decay_tokens ................................. 300000000000
[default0]:  lr_warmup_fraction .............................. None
[default0]:  lr_warmup_iters ................................. 0
[default0]:  lr_warmup_samples ............................... 0
[default0]:  lr_warmup_tokens ................................ 375000000
[default0]:  make_vocab_size_divisible_by .................... 128
[default0]:  mask_factor ..................................... 1.0
[default0]:  mask_prob ....................................... 0.15
[default0]:  mask_type ....................................... random
[default0]:  masked_softmax_fusion ........................... True
[default0]:  max_position_embeddings ......................... 2048
[default0]:  max_tokens_to_oom ............................... 12000
[default0]:  memory_centric_tiled_linear ..................... False
[default0]:  merge_file ...................................... /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/gpt2-merges.txt
[default0]:  micro_batch_size ................................ 32
[default0]:  min_loss_scale .................................. 1.0
[default0]:  min_lr .......................................... 2e-06
[default0]:  mlp_type ........................................ standard
[default0]:  mmap_warmup ..................................... False
[default0]:  moe_eval_capacity_factor ........................ 1.0
[default0]:  moe_expert_parallel_size ........................ 16
[default0]:  moe_loss_coeff .................................. 0.01
[default0]:  moe_min_capacity ................................ 4
[default0]:  moe_token_dropping .............................. True
[default0]:  moe_train_capacity_factor ....................... 1.0
[default0]:  mos ............................................. False
[default0]:  no_load_lr_state ................................ False
[default0]:  no_load_optim ................................... None
[default0]:  no_load_rng ..................................... None
[default0]:  no_persist_layer_norm ........................... False
[default0]:  no_pipeline_parallel ............................ True
[default0]:  no_save_optim ................................... None
[default0]:  no_save_rng ..................................... None
[default0]:  normalization ................................... layernorm
[default0]:  num_attention_heads ............................. 40
[default0]:  num_attention_heads_teacher ..................... None
[default0]:  num_channels .................................... 3
[default0]:  num_classes ..................................... 1000
[default0]:  num_experts ..................................... [128]
[default0]:  num_experts_switch .............................. None
[default0]:  num_experts_teacher ............................. [1]
[default0]:  num_layers ...................................... 40
[default0]:  num_layers_per_virtual_pipeline_stage ........... None
[default0]:  num_layers_teacher .............................. None
[default0]:  num_workers ..................................... 0
[default0]:  onnx_safe ....................................... None
[default0]:  openai_gelu ..................................... False
[default0]:  optimizer ....................................... adam
[default0]:  output_bert_embeddings .......................... False
[default0]:  overlap_p2p_comm ................................ False
[default0]:  override_opt_param_scheduler .................... True
[default0]:  params_dtype .................................... torch.float16
[default0]:  partition_activations ........................... False
[default0]:  patch_dim ....................................... 16
[default0]:  perform_initialization .......................... True
[default0]:  pipeline_model_parallel_size .................... 1
[default0]:  pipeline_model_parallel_split_rank .............. None
[default0]:  profile_backward ................................ False
[default0]:  query_in_block_prob ............................. 0.1
[default0]:  rampup_batch_size ............................... None
[default0]:  random_ltd ...................................... False
[default0]:  rank ............................................ 0
[default0]:  recompute_granularity ........................... None
[default0]:  recompute_method ................................ None
[default0]:  recompute_num_layers ............................ 1
[default0]:  remote_device ................................... none
[default0]:  reset_attention_mask ............................ False
[default0]:  reset_iteration ................................. False
[default0]:  reset_position_ids .............................. False
[default0]:  retriever_report_topk_accuracies ................ []
[default0]:  retriever_score_scaling ......................... False
[default0]:  retriever_seq_length ............................ 256
[default0]:  retro_add_retriever ............................. False
[default0]:  retro_cyclic_train_iters ........................ None
[default0]:  retro_encoder_attention_dropout ................. 0.1
[default0]:  retro_encoder_hidden_dropout .................... 0.1
[default0]:  retro_encoder_layers ............................ 2
[default0]:  retro_num_neighbors ............................. 2
[default0]:  retro_num_retrieved_chunks ...................... 2
[default0]:  retro_return_doc_ids ............................ False
[default0]:  retro_workdir ................................... None
[default0]:  return_data_index ............................... False
[default0]:  rotary_percent .................................. 1.0
[default0]:  sample_rate ..................................... 1.0
[default0]:  save ............................................ /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_13B_MoE128_32BATCH_16GPU_4Node/checkpoint/gpt-13B-lr-2.0e-4-minlr-2e-06-bs-512-gpus-16-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true
[default0]:  save_interval ................................... 1000000
[default0]:  scatter_gather_tensors_in_pipeline .............. True
[default0]:  scattered_embeddings ............................ False
[default0]:  seed ............................................ 1234
[default0]:  seq_length ...................................... 2048
[default0]:  sequence_parallel ............................... False
[default0]:  sgd_momentum .................................... 0.9
[default0]:  short_seq_prob .................................. 0.1
[default0]:  skip_train ...................................... False
[default0]:  split ........................................... 98,2,0
[default0]:  split_transformers .............................. False
[default0]:  squared_relu .................................... False
[default0]:  standalone_embedding_stage ...................... False
[default0]:  start_weight_decay .............................. 0.1
[default0]:  swiglu .......................................... False
[default0]:  swin_backbone_type .............................. tiny
[default0]:  synchronize_each_layer .......................... False
[default0]:  tensor_model_parallel_size ...................... 1
[default0]:  tensorboard_dir ................................. /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/lola_ws/scaling_experiments/output/GPT_13B_MoE128_32BATCH_16GPU_4Node/tensorboard/gpt-13B-lr-2.0e-4-minlr-2e-06-bs-512-gpus-16-mp-1-pp-1-ep-128-mlc-0.01-cap-1.0-drop-true_n2gpu1207_2023.07.31-05.16.23
[default0]:  tensorboard_log_interval ........................ 1
[default0]:  tensorboard_queue_size .......................... 1
[default0]:  test_data_path .................................. None
[default0]:  tile_factor ..................................... 1
[default0]:  timing_log_level ................................ 0
[default0]:  timing_log_option ............................... minmax
[default0]:  titles_data_path ................................ None
[default0]:  tokenizer_model ................................. None
[default0]:  tokenizer_type .................................. GPT2BPETokenizer
[default0]:  topk ............................................ 1
[default0]:  train_data_exact_num_epochs ..................... None
[default0]:  train_data_path ................................. None
[default0]:  train_desc_path ................................. None
[default0]:  train_doc_idx_path .............................. None
[default0]:  train_idx_path .................................. None
[default0]:  train_iters ..................................... 858306
[default0]:  train_sample_idx_path ........................... None
[default0]:  train_samples ................................... None
[default0]:  train_shuffle_idx_path .......................... None
[default0]:  train_tokens .................................... 300000000000
[default0]:  transformer_impl ................................ local
[default0]:  transformer_pipeline_model_parallel_size ........ 1
[default0]:  untie_embeddings_and_output_weights ............. False
[default0]:  use_checkpoint_args ............................. False
[default0]:  use_checkpoint_opt_param_scheduler .............. False
[default0]:  use_contiguous_buffers_in_local_ddp ............. True
[default0]:  use_cpu_initialization .......................... None
[default0]:  use_distributed_optimizer ....................... False
[default0]:  use_flash_attn .................................. False
[default0]:  use_one_sent_docs ............................... False
[default0]:  use_pin_memory .................................. False
[default0]:  use_ring_exchange_p2p ........................... False
[default0]:  use_rotary_position_embeddings .................. False
[default0]:  use_tutel ....................................... False
[default0]:  valid_data_path ................................. None
[default0]:  variable_seq_lengths ............................ False
[default0]:  virtual_pipeline_model_parallel_size ............ None
[default0]:  vision_backbone_type ............................ vit
[default0]:  vision_pretraining .............................. False
[default0]:  vision_pretraining_type ......................... classify
[default0]:  vocab_extra_ids ................................. 0
[default0]:  vocab_file ...................................... /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/data/gpt2-vocab.json
[default0]:  vocab_size ...................................... None
[default0]:  weight_decay .................................... 0.1
[default0]:  weight_decay_incr_style ......................... constant
[default0]:  world_size ...................................... 16
[default0]:  zero_allgather_bucket_size ...................... 0.0
[default0]:  zero_contigious_gradients ....................... False
[default0]:  zero_reduce_bucket_size ......................... 0.0
[default0]:  zero_reduce_scatter ............................. False
[default0]:  zero_stage ...................................... 1.0
[default0]:-------------------- end of arguments ---------------------
[default0]:setting number of micro-batches to constant 1
[default0]:> building GPT2BPETokenizer tokenizer ...
[default2]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default0]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default2]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default3]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default2]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default0]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default3]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default1]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default0]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default2]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default1]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default3]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default1]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default1]:**** Git info for Megatron: git_hash=421a479 git_branch=main ****
[default1]:[2023-07-31 05:16:54,181] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default3]:[2023-07-31 05:16:54,186] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default3]:[2023-07-31 05:16:54,186] [INFO] [comm.py:616:init_distributed] cdb=None
[default1]:[2023-07-31 05:16:54,185] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default1]:[2023-07-31 05:16:54,185] [INFO] [comm.py:616:init_distributed] cdb=None
[default0]: > padded vocab (size: 50257) with 47 dummy tokens (new size: 50304)
[default0]:> initializing torch distributed ...
[default0]:[2023-07-31 05:16:54,187] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default0]:[2023-07-31 05:16:54,187] [INFO] [comm.py:616:init_distributed] cdb=None
[default0]:[2023-07-31 05:16:54,187] [INFO] [comm.py:643:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[default2]:[2023-07-31 05:16:54,177] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default2]:[2023-07-31 05:16:54,177] [INFO] [comm.py:616:init_distributed] cdb=None
[default0]:[2023-07-31 05:16:54,186] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default0]:[2023-07-31 05:16:54,186] [INFO] [comm.py:616:init_distributed] cdb=None
[default2]:[2023-07-31 05:16:54,188] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default2]:[2023-07-31 05:16:54,188] [INFO] [comm.py:616:init_distributed] cdb=None
[default3]:[2023-07-31 05:16:54,162] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default3]:[2023-07-31 05:16:54,162] [INFO] [comm.py:616:init_distributed] cdb=None
[default2]:[2023-07-31 05:16:54,183] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default2]:[2023-07-31 05:16:54,183] [INFO] [comm.py:616:init_distributed] cdb=None
[default0]:[2023-07-31 05:16:54,186] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default0]:[2023-07-31 05:16:54,186] [INFO] [comm.py:616:init_distributed] cdb=None
[default1]:[2023-07-31 05:16:54,187] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default1]:[2023-07-31 05:16:54,187] [INFO] [comm.py:616:init_distributed] cdb=None
[default3]:[2023-07-31 05:16:54,185] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default3]:[2023-07-31 05:16:54,185] [INFO] [comm.py:616:init_distributed] cdb=None
[default1]:[2023-07-31 05:16:54,186] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default1]:[2023-07-31 05:16:54,186] [INFO] [comm.py:616:init_distributed] cdb=None
[default0]:[2023-07-31 05:16:54,186] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default0]:[2023-07-31 05:16:54,186] [INFO] [comm.py:616:init_distributed] cdb=None
[default2]:[2023-07-31 05:16:54,184] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default2]:[2023-07-31 05:16:54,184] [INFO] [comm.py:616:init_distributed] cdb=None
[default1]:[2023-07-31 05:16:54,188] [INFO] [comm.py:616:init_distributed] cdb=None
[default3]:> setting tensorboard ...
[default3]:[2023-07-31 05:16:56,059] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[default3]:[2023-07-31 05:16:56,059] [INFO] [comm.py:616:init_distributed] cdb=None
[default0]:> initialized tensor model parallel with size 1
[default0]:> initialized pipeline model parallel with size 1
[default0]:> setting random seeds to 1234 ...
[default0]:> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
[default0]:> compiling dataset index builder ...
[default0]:make: Entering directory '/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/data'
[default0]:make: Nothing to be done for 'default'.
[default0]:make: Leaving directory '/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/data'
[default0]:>>> done with dataset index builder. Compilation time: 1.503 seconds
[default0]:> compiling and loading fused kernels ...
[default0]:Detected CUDA files, patching ldflags
[default0]:Emitting ninja build file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/fused_kernels/build/build.ninja...
[default0]:Building extension module scaled_upper_triang_masked_softmax_cuda...
[default0]:Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[default0]:ninja: no work to do.
[default0]:Loading extension module scaled_upper_triang_masked_softmax_cuda...
[default0]:Detected CUDA files, patching ldflags
[default0]:Emitting ninja build file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/fused_kernels/build/build.ninja...
[default0]:Building extension module scaled_masked_softmax_cuda...
[default0]:Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[default0]:ninja: no work to do.
[default0]:Loading extension module scaled_masked_softmax_cuda...
[default0]:Detected CUDA files, patching ldflags
[default0]:Emitting ninja build file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/fused_kernels/build/build.ninja...
[default0]:Building extension module scaled_softmax_cuda...
[default0]:Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[default0]:ninja: no work to do.
[default0]:Loading extension module scaled_softmax_cuda...
[default0]:n2gpu1207:436554:436554 [0] NCCL INFO Bootstrap : Using ib1:10.10.103.75<0>
[default0]:n2gpu1207:436554:436554 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default0]:n2gpu1207:436554:436554 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.75<0>
[default0]:n2gpu1207:436554:436554 [0] NCCL INFO Using network IB
[default0]:NCCL version 2.12.12+cuda11.7
[default1]:n2gpu1223:1438921:1438921 [1] NCCL INFO Bootstrap : Using ib1:10.10.103.91<0>
[default2]:n2gpu1224:2602556:2602556 [2] NCCL INFO Bootstrap : Using ib1:10.10.103.92<0>
[default0]:n2gpu1224:2602554:2602554 [0] NCCL INFO Bootstrap : Using ib1:10.10.103.92<0>
[default3]:n2gpu1222:1222639:1222639 [3] NCCL INFO Bootstrap : Using ib1:10.10.103.90<0>
[default1]:n2gpu1222:1222637:1222637 [1] NCCL INFO Bootstrap : Using ib1:10.10.103.90<0>
[default3]:n2gpu1224:2602557:2602557 [3] NCCL INFO Bootstrap : Using ib1:10.10.103.92<0>
[default1]:n2gpu1224:2602555:2602555 [1] NCCL INFO Bootstrap : Using ib1:10.10.103.92<0>
[default3]:n2gpu1223:1438923:1438923 [3] NCCL INFO Bootstrap : Using ib1:10.10.103.91<0>
[default3]:n2gpu1223:1438923:1438923 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default0]:n2gpu1223:1438920:1438920 [0] NCCL INFO Bootstrap : Using ib1:10.10.103.91<0>
[default0]:n2gpu1223:1438920:1438920 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default0]:n2gpu1223:1438920:1438920 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.91<0>
[default0]:n2gpu1223:1438920:1438920 [0] NCCL INFO Using network IB
[default2]:n2gpu1223:1438922:1438922 [2] NCCL INFO Bootstrap : Using ib1:10.10.103.91<0>
[default2]:n2gpu1223:1438922:1438922 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default1]:n2gpu1207:436555:436555 [1] NCCL INFO Bootstrap : Using ib1:10.10.103.75<0>
[default1]:n2gpu1207:436555:436555 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default1]:n2gpu1223:1438921:1438921 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default1]:n2gpu1223:1438921:1438921 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.91<0>
[default1]:n2gpu1223:1438921:1438921 [1] NCCL INFO Using network IB
[default2]:n2gpu1224:2602556:2602556 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default2]:n2gpu1224:2602556:2602556 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.92<0>
[default2]:n2gpu1224:2602556:2602556 [2] NCCL INFO Using network IB
[default2]:n2gpu1222:1222638:1222638 [2] NCCL INFO Bootstrap : Using ib1:10.10.103.90<0>
[default2]:n2gpu1222:1222638:1222638 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default2]:n2gpu1222:1222638:1222638 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.90<0>
[default2]:n2gpu1222:1222638:1222638 [2] NCCL INFO Using network IB
[default0]:n2gpu1222:1222636:1222636 [0] NCCL INFO Bootstrap : Using ib1:10.10.103.90<0>
[default0]:n2gpu1222:1222636:1222636 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default0]:n2gpu1222:1222636:1222636 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.90<0>
[default0]:n2gpu1222:1222636:1222636 [0] NCCL INFO Using network IB
[default3]:n2gpu1222:1222639:1222639 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default3]:n2gpu1222:1222639:1222639 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.90<0>
[default3]:n2gpu1222:1222639:1222639 [3] NCCL INFO Using network IB
[default1]:n2gpu1222:1222637:1222637 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default1]:n2gpu1222:1222637:1222637 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.90<0>
[default1]:n2gpu1222:1222637:1222637 [1] NCCL INFO Using network IB
[default3]:n2gpu1224:2602557:2602557 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default3]:n2gpu1224:2602557:2602557 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.92<0>
[default3]:n2gpu1224:2602557:2602557 [3] NCCL INFO Using network IB
[default0]:n2gpu1224:2602554:2602554 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default0]:n2gpu1224:2602554:2602554 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.92<0>
[default0]:n2gpu1224:2602554:2602554 [0] NCCL INFO Using network IB
[default1]:n2gpu1224:2602555:2602555 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default1]:n2gpu1224:2602555:2602555 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.92<0>
[default1]:n2gpu1224:2602555:2602555 [1] NCCL INFO Using network IB
[default3]:n2gpu1223:1438923:1438923 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.91<0>
[default3]:n2gpu1223:1438923:1438923 [3] NCCL INFO Using network IB
[default2]:n2gpu1223:1438922:1438922 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.91<0>
[default2]:n2gpu1223:1438922:1438922 [2] NCCL INFO Using network IB
[default2]:n2gpu1207:436556:436556 [2] NCCL INFO Bootstrap : Using ib1:10.10.103.75<0>
[default2]:n2gpu1207:436556:436556 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default3]:n2gpu1207:436557:436557 [3] NCCL INFO Bootstrap : Using ib1:10.10.103.75<0>
[default3]:n2gpu1207:436557:436557 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
[default3]:n2gpu1207:436557:436557 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.75<0>
[default3]:n2gpu1207:436557:436557 [3] NCCL INFO Using network IB
[default2]:n2gpu1207:436556:436556 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.75<0>
[default2]:n2gpu1207:436556:436556 [2] NCCL INFO Using network IB
[default1]:n2gpu1207:436555:436555 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib1:10.10.103.75<0>
[default1]:n2gpu1207:436555:436555 [1] NCCL INFO Using network IB
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Trees [0] 15/-1/-1->14->13 [1] 15/-1/-1->14->13 [2] 15/-1/-1->14->13 [3] 15/-1/-1->14->13
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Trees [0] 14/-1/-1->13->12 [1] 14/-1/-1->13->12 [2] 14/-1/-1->13->12 [3] 14/-1/-1->13->12
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Trees [0] -1/-1/-1->15->14 [1] -1/-1/-1->15->14 [2] -1/-1/-1->15->14 [3] -1/-1/-1->15->14
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 2/-1/-1->1->0 [3] 2/-1/-1->1->0
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 00/04 :    0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 01/04 :    0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 02/04 :    0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 03/04 :    0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Trees [0] 1/8/-1->0->-1 [1] 1/8/-1->0->-1 [2] 1/-1/-1->0->4 [3] 1/-1/-1->0->4
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] -1/-1/-1->3->2 [3] -1/-1/-1->3->2
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] 3/-1/-1->2->1 [3] 3/-1/-1->2->1
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 00/0 : 15[c4000] -> 0[3000] [receive] via NET/IB/0
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Trees [0] 5/-1/-1->4->9 [1] 5/-1/-1->4->9 [2] 5/0/-1->4->12 [3] 5/0/-1->4->12
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Trees [0] 7/-1/-1->6->5 [1] 7/-1/-1->6->5 [2] 7/-1/-1->6->5 [3] 7/-1/-1->6->5
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Trees [0] 6/-1/-1->5->4 [1] 6/-1/-1->5->4 [2] 6/8/-1->5->4 [3] 6/8/-1->5->4
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 00/0 : 3[c4000] -> 4[3000] [receive] via NET/IB/0
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Trees [0] -1/-1/-1->7->6 [1] -1/-1/-1->7->6 [2] -1/-1/-1->7->6 [3] -1/-1/-1->7->6
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Trees [0] 9/12/-1->8->0 [1] 9/12/-1->8->0 [2] 9/-1/-1->8->5 [3] 9/-1/-1->8->5
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Trees [0] 11/-1/-1->10->9 [1] 11/-1/-1->10->9 [2] 11/-1/-1->10->9 [3] 11/-1/-1->10->9
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 01/0 : 15[c4000] -> 0[3000] [receive] via NET/IB/0
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Trees [0] 10/4/-1->9->8 [1] 10/4/-1->9->8 [2] 10/-1/-1->9->8 [3] 10/-1/-1->9->8
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Trees [0] -1/-1/-1->11->10 [1] -1/-1/-1->11->10 [2] -1/-1/-1->11->10 [3] -1/-1/-1->11->10
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 00/0 : 7[c4000] -> 8[3000] [receive] via NET/IB/0
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Trees [0] 13/-1/-1->12->8 [1] 13/-1/-1->12->8 [2] 13/4/-1->12->-1 [3] 13/4/-1->12->-1
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 02/0 : 15[c4000] -> 0[3000] [receive] via NET/IB/0
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 01/0 : 3[c4000] -> 4[3000] [receive] via NET/IB/0
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Channel 00 : 13[44000] -> 14[84000] via P2P/IPC/read
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 01/0 : 7[c4000] -> 8[3000] [receive] via NET/IB/0
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 03/0 : 15[c4000] -> 0[3000] [receive] via NET/IB/0
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 00 : 0[3000] -> 1[44000] via P2P/IPC/read
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Channel 00 : 1[44000] -> 2[84000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 00/0 : 11[c4000] -> 12[3000] [receive] via NET/IB/0
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Channel 01 : 13[44000] -> 14[84000] via P2P/IPC/read
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 01 : 0[3000] -> 1[44000] via P2P/IPC/read
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 02/0 : 3[c4000] -> 4[3000] [receive] via NET/IB/0
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 01/0 : 11[c4000] -> 12[3000] [receive] via NET/IB/0
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Channel 00 : 14[84000] -> 15[c4000] via P2P/IPC/read
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Channel 01 : 14[84000] -> 15[c4000] via P2P/IPC/read
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Channel 00/0 : 15[c4000] -> 0[3000] [send] via NET/IB/0
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Channel 01/0 : 15[c4000] -> 0[3000] [send] via NET/IB/0
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Channel 00 : 2[84000] -> 3[c4000] via P2P/IPC/read
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 02/0 : 7[c4000] -> 8[3000] [receive] via NET/IB/0
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 02 : 0[3000] -> 1[44000] via P2P/IPC/read
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 03/0 : 3[c4000] -> 4[3000] [receive] via NET/IB/0
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 00 : 4[3000] -> 5[44000] via P2P/IPC/read
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 03 : 0[3000] -> 1[44000] via P2P/IPC/read
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Channel 00/0 : 3[c4000] -> 4[3000] [send] via NET/IB/0
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Channel 02/0 : 15[c4000] -> 0[3000] [send] via NET/IB/0
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 03/0 : 7[c4000] -> 8[3000] [receive] via NET/IB/0
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 00 : 8[3000] -> 9[44000] via P2P/IPC/read
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 00 : 9[44000] -> 10[84000] via P2P/IPC/read
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Channel 00/0 : 7[c4000] -> 8[3000] [send] via NET/IB/0
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 00 : 5[44000] -> 6[84000] via P2P/IPC/read
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Channel 01 : 1[44000] -> 2[84000] via P2P/IPC/read
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Channel 01/0 : 3[c4000] -> 4[3000] [send] via NET/IB/0
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Channel 01 : 2[84000] -> 3[c4000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 02/0 : 11[c4000] -> 12[3000] [receive] via NET/IB/0
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Channel 02 : 14[84000] -> 15[c4000] via P2P/IPC/read
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Channel 02 : 13[44000] -> 14[84000] via P2P/IPC/read
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Channel 03/0 : 15[c4000] -> 0[3000] [send] via NET/IB/0
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 01 : 4[3000] -> 5[44000] via P2P/IPC/read
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Channel 01/0 : 7[c4000] -> 8[3000] [send] via NET/IB/0
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Channel 00 : 6[84000] -> 7[c4000] via P2P/IPC/read
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Channel 01 : 6[84000] -> 7[c4000] via P2P/IPC/read
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Channel 02 : 1[44000] -> 2[84000] via P2P/IPC/read
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Channel 02/0 : 3[c4000] -> 4[3000] [send] via NET/IB/0
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Channel 03 : 13[44000] -> 14[84000] via P2P/IPC/read
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 01 : 8[3000] -> 9[44000] via P2P/IPC/read
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 02 : 8[3000] -> 9[44000] via P2P/IPC/read
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 01 : 9[44000] -> 10[84000] via P2P/IPC/read
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Channel 02/0 : 7[c4000] -> 8[3000] [send] via NET/IB/0
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Channel 03/0 : 7[c4000] -> 8[3000] [send] via NET/IB/0
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 01 : 5[44000] -> 6[84000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 03/0 : 11[c4000] -> 12[3000] [receive] via NET/IB/0
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 00 : 12[3000] -> 13[44000] via P2P/IPC/read
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Channel 03 : 14[84000] -> 15[c4000] via P2P/IPC/read
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Channel 03/0 : 3[c4000] -> 4[3000] [send] via NET/IB/0
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Channel 02 : 2[84000] -> 3[c4000] via P2P/IPC/read
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Channel 00/0 : 11[c4000] -> 12[3000] [send] via NET/IB/0
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Channel 00 : 10[84000] -> 11[c4000] via P2P/IPC/read
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 02 : 4[3000] -> 5[44000] via P2P/IPC/read
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Channel 02 : 6[84000] -> 7[c4000] via P2P/IPC/read
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 02 : 5[44000] -> 6[84000] via P2P/IPC/read
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Channel 03 : 1[44000] -> 2[84000] via P2P/IPC/read
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Channel 03 : 2[84000] -> 3[c4000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 01 : 12[3000] -> 13[44000] via P2P/IPC/read
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Channel 01/0 : 11[c4000] -> 12[3000] [send] via NET/IB/0
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 03 : 8[3000] -> 9[44000] via P2P/IPC/read
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Channel 01 : 10[84000] -> 11[c4000] via P2P/IPC/read
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 02 : 9[44000] -> 10[84000] via P2P/IPC/read
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Channel 03 : 6[84000] -> 7[c4000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 02 : 12[3000] -> 13[44000] via P2P/IPC/read
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Connected all rings
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Connected all rings
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Channel 02/0 : 11[c4000] -> 12[3000] [send] via NET/IB/0
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Channel 03/0 : 11[c4000] -> 12[3000] [send] via NET/IB/0
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 03 : 9[44000] -> 10[84000] via P2P/IPC/read
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 03 : 4[3000] -> 5[44000] via P2P/IPC/read
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Connected all rings
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Channel 02 : 10[84000] -> 11[c4000] via P2P/IPC/read
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Connected all rings
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 03 : 5[44000] -> 6[84000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 03 : 12[3000] -> 13[44000] via P2P/IPC/read
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Channel 03 : 10[84000] -> 11[c4000] via P2P/IPC/read
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Connected all rings
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Connected all rings
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Channel 00 : 15[c4000] -> 14[84000] via P2P/IPC/read
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 02/0 : 5[44000] -> 8[3000] [send] via NET/IB/1
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Connected all rings
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Connected all rings
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Connected all rings
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Connected all rings
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 03/0 : 5[44000] -> 8[3000] [send] via NET/IB/1
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Channel 00 : 14[84000] -> 13[44000] via P2P/IPC/read
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Channel 01 : 15[c4000] -> 14[84000] via P2P/IPC/read
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Connected all rings
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Connected all rings
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Channel 00 : 7[c4000] -> 6[84000] via P2P/IPC/read
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Channel 01 : 14[84000] -> 13[44000] via P2P/IPC/read
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 02/0 : 0[3000] -> 4[3000] [send] via NET/IB/1
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Connected all rings
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Channel 00 : 3[c4000] -> 2[84000] via P2P/IPC/read
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 00/0 : 4[3000] -> 9[44000] [receive] via NET/IB/1
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Channel 02 : 15[c4000] -> 14[84000] via P2P/IPC/read
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 03/0 : 0[3000] -> 4[3000] [send] via NET/IB/1
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Channel 00 : 1[44000] -> 0[3000] via P2P/IPC/read
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 02/0 : 0[3000] -> 4[3000] [receive] via NET/IB/1
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Channel 01 : 7[c4000] -> 6[84000] via P2P/IPC/read
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Channel 01 : 1[44000] -> 0[3000] via P2P/IPC/read
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Channel 01 : 3[c4000] -> 2[84000] via P2P/IPC/read
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Channel 00 : 2[84000] -> 1[44000] via P2P/IPC/read
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Connected all rings
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 01/0 : 4[3000] -> 9[44000] [receive] via NET/IB/1
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Channel 02 : 14[84000] -> 13[44000] via P2P/IPC/read
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Channel 03 : 15[c4000] -> 14[84000] via P2P/IPC/read
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 03/0 : 0[3000] -> 4[3000] [receive] via NET/IB/1
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Channel 02 : 7[c4000] -> 6[84000] via P2P/IPC/read
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Channel 01 : 2[84000] -> 1[44000] via P2P/IPC/read
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Connected all rings
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Channel 00 : 11[c4000] -> 10[84000] via P2P/IPC/read
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Channel 00 : 6[84000] -> 5[44000] via P2P/IPC/read
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Channel 02 : 1[44000] -> 0[3000] via P2P/IPC/read
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Channel 02 : 3[c4000] -> 2[84000] via P2P/IPC/read
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Channel 03 : 14[84000] -> 13[44000] via P2P/IPC/read
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Channel 00 : 13[44000] -> 12[3000] via P2P/IPC/read
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Channel 03 : 7[c4000] -> 6[84000] via P2P/IPC/read
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Channel 03 : 1[44000] -> 0[3000] via P2P/IPC/read
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Channel 03 : 3[c4000] -> 2[84000] via P2P/IPC/read
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Channel 02 : 2[84000] -> 1[44000] via P2P/IPC/read
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Channel 01 : 11[c4000] -> 10[84000] via P2P/IPC/read
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 02/0 : 5[44000] -> 8[3000] [receive] via NET/IB/1
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Channel 00 : 10[84000] -> 9[44000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Connected all rings
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO Connected all trees
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Channel 01 : 6[84000] -> 5[44000] via P2P/IPC/read
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Channel 01 : 13[44000] -> 12[3000] via P2P/IPC/read
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Channel 02 : 6[84000] -> 5[44000] via P2P/IPC/read
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 00/0 : 8[3000] -> 0[3000] [receive] via NET/IB/1
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Channel 03 : 2[84000] -> 1[44000] via P2P/IPC/read
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Channel 02 : 11[c4000] -> 10[84000] via P2P/IPC/read
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 03/0 : 5[44000] -> 8[3000] [receive] via NET/IB/1
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Channel 01 : 10[84000] -> 9[44000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 00/0 : 8[3000] -> 12[3000] [receive] via NET/IB/1
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Channel 02 : 13[44000] -> 12[3000] via P2P/IPC/read
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 00/0 : 4[3000] -> 9[44000] [send] via NET/IB/1
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO Connected all trees
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO Connected all trees
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 01/0 : 8[3000] -> 12[3000] [receive] via NET/IB/1
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Channel 03 : 13[44000] -> 12[3000] via P2P/IPC/read
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Channel 03 : 6[84000] -> 5[44000] via P2P/IPC/read
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 01/0 : 8[3000] -> 0[3000] [receive] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 01/0 : 4[3000] -> 9[44000] [send] via NET/IB/1
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Channel 03 : 11[c4000] -> 10[84000] via P2P/IPC/read
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Channel 02 : 10[84000] -> 9[44000] via P2P/IPC/read
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO Connected all trees
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 02/0 : 8[3000] -> 5[44000] [receive] via NET/IB/1
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 00/0 : 0[3000] -> 8[3000] [send] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 00/0 : 8[3000] -> 12[3000] [send] via NET/IB/1
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Channel 03 : 10[84000] -> 9[44000] via P2P/IPC/read
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 03/0 : 8[3000] -> 5[44000] [receive] via NET/IB/1
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO Connected all trees
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 01/0 : 0[3000] -> 8[3000] [send] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 01/0 : 8[3000] -> 12[3000] [send] via NET/IB/1
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO Connected all trees
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 00/0 : 9[44000] -> 4[3000] [send] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 02/0 : 12[3000] -> 4[3000] [receive] via NET/IB/1
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 01/0 : 9[44000] -> 4[3000] [send] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 00/0 : 0[3000] -> 8[3000] [receive] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 03/0 : 12[3000] -> 4[3000] [receive] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 02/0 : 4[3000] -> 12[3000] [send] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 01/0 : 0[3000] -> 8[3000] [receive] via NET/IB/1
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 02/0 : 4[3000] -> 12[3000] [receive] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 00/0 : 8[3000] -> 0[3000] [send] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 03/0 : 4[3000] -> 12[3000] [send] via NET/IB/1
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 03/0 : 4[3000] -> 12[3000] [receive] via NET/IB/1
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 02/0 : 12[3000] -> 4[3000] [send] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 01/0 : 8[3000] -> 0[3000] [send] via NET/IB/1
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 03/0 : 12[3000] -> 4[3000] [send] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 00/0 : 9[44000] -> 4[3000] [receive] via NET/IB/1
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 00/0 : 12[3000] -> 8[3000] [send] via NET/IB/1
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Channel 01/0 : 12[3000] -> 8[3000] [send] via NET/IB/1
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 02/0 : 4[3000] -> 0[3000] [receive] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 00/0 : 12[3000] -> 8[3000] [receive] via NET/IB/1
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Channel 03/0 : 4[3000] -> 0[3000] [receive] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 01/0 : 9[44000] -> 4[3000] [receive] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 01/0 : 12[3000] -> 8[3000] [receive] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 02/0 : 4[3000] -> 0[3000] [send] via NET/IB/1
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Channel 03/0 : 4[3000] -> 0[3000] [send] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 02/0 : 8[3000] -> 5[44000] [send] via NET/IB/1
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Channel 03/0 : 8[3000] -> 5[44000] [send] via NET/IB/1
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 00 : 9[44000] -> 8[3000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO Connected all trees
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO Connected all trees
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 01 : 9[44000] -> 8[3000] via P2P/IPC/read
[default0]:n2gpu1224:2602554:2602735 [0] NCCL INFO comm 0x14af380090d0 rank 12 nranks 16 cudaDev 0 busId 3000 - Init COMPLETE
[default2]:n2gpu1224:2602556:2602733 [2] NCCL INFO comm 0x14fc980090d0 rank 14 nranks 16 cudaDev 2 busId 84000 - Init COMPLETE
[default1]:n2gpu1224:2602555:2602728 [1] NCCL INFO comm 0x153ab80090d0 rank 13 nranks 16 cudaDev 1 busId 44000 - Init COMPLETE
[default3]:n2gpu1224:2602557:2602730 [3] NCCL INFO comm 0x1454b40090d0 rank 15 nranks 16 cudaDev 3 busId c4000 - Init COMPLETE
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 02 : 9[44000] -> 8[3000] via P2P/IPC/read
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO Connected all trees
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Channel 03 : 9[44000] -> 8[3000] via P2P/IPC/read
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO Connected all trees
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default0]:n2gpu1207:436554:436798 [0] NCCL INFO comm 0x14aa880090d0 rank 0 nranks 16 cudaDev 0 busId 3000 - Init COMPLETE
[default0]:n2gpu1207:436554:436554 [0] NCCL INFO Launch mode Parallel
[default1]:n2gpu1207:436555:436807 [1] NCCL INFO comm 0x14feb40090d0 rank 1 nranks 16 cudaDev 1 busId 44000 - Init COMPLETE
[default3]:n2gpu1207:436557:436803 [3] NCCL INFO comm 0x148b480090d0 rank 3 nranks 16 cudaDev 3 busId c4000 - Init COMPLETE
[default2]:n2gpu1207:436556:436805 [2] NCCL INFO comm 0x1468a80090d0 rank 2 nranks 16 cudaDev 2 busId 84000 - Init COMPLETE
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO Connected all trees
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO Connected all trees
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO Connected all trees
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default3]:n2gpu1223:1438923:1439095 [3] NCCL INFO comm 0x1518b80090d0 rank 11 nranks 16 cudaDev 3 busId c4000 - Init COMPLETE
[default0]:n2gpu1223:1438920:1439093 [0] NCCL INFO comm 0x14b3200090d0 rank 8 nranks 16 cudaDev 0 busId 3000 - Init COMPLETE
[default2]:n2gpu1223:1438922:1439100 [2] NCCL INFO comm 0x14c2bc0090d0 rank 10 nranks 16 cudaDev 2 busId 84000 - Init COMPLETE
[default1]:n2gpu1223:1438921:1439097 [1] NCCL INFO comm 0x14a70c0090d0 rank 9 nranks 16 cudaDev 1 busId 44000 - Init COMPLETE
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 00 : 5[44000] -> 4[3000] via P2P/IPC/read
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 01 : 5[44000] -> 4[3000] via P2P/IPC/read
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 02 : 5[44000] -> 4[3000] via P2P/IPC/read
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Channel 03 : 5[44000] -> 4[3000] via P2P/IPC/read
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO Connected all trees
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO Connected all trees
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO Connected all trees
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/512
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
[default0]:n2gpu1222:1222636:1222813 [0] NCCL INFO comm 0x14e5ec0090d0 rank 4 nranks 16 cudaDev 0 busId 3000 - Init COMPLETE
[default3]:n2gpu1222:1222639:1222809 [3] NCCL INFO comm 0x14c06c0090d0 rank 7 nranks 16 cudaDev 3 busId c4000 - Init COMPLETE
[default2]:n2gpu1222:1222638:1222811 [2] NCCL INFO comm 0x14a6a40090d0 rank 6 nranks 16 cudaDev 2 busId 84000 - Init COMPLETE
[default1]:n2gpu1222:1222637:1222815 [1] NCCL INFO comm 0x145ce00090d0 rank 5 nranks 16 cudaDev 1 busId 44000 - Init COMPLETE
[default0]:>>> done with compiling and loading fused kernels. Compilation time: 16.348 seconds
[default0]:Traceback (most recent call last):
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default0]:    pretrain(train_valid_test_datasets_provider,
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default2]:Traceback (most recent call last):
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default2]:    pretrain(train_valid_test_datasets_provider,
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default1]:Traceback (most recent call last):
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default3]:Traceback (most recent call last):
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default3]:    pretrain(train_valid_test_datasets_provider,
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default3]:Traceback (most recent call last):
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default3]:    pretrain(train_valid_test_datasets_provider,
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default3]:    set_jit_fusion_options()
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default0]:Traceback (most recent call last):
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default0]:    pretrain(train_valid_test_datasets_provider,
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default0]:    set_jit_fusion_options()
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default0]:    _warmup_jit_function()
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default0]:    output = bias_gelu(bias, input)
[default0]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default0]:Traceback of TorchScript (most recent call last):
[default0]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default0]:Traceback of TorchScript (most recent call last):
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default0]:def bias_gelu(bias, y):
[default0]:    x = bias + y
[default0]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default0]:                             ~~~~~~~~~~ <--- HERE
[default0]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 0; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.26 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default0]:
[default0]:
[default1]:Traceback (most recent call last):
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default1]:    pretrain(train_valid_test_datasets_provider,
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default1]:    set_jit_fusion_options()
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default3]:Traceback (most recent call last):
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default3]:    pretrain(train_valid_test_datasets_provider,
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default3]:    set_jit_fusion_options()
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default3]:    _warmup_jit_function()
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default3]:    output = bias_gelu(bias, input)
[default3]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default3]:Traceback of TorchScript (most recent call last):
[default3]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default3]:Traceback of TorchScript (most recent call last):
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default3]:def bias_gelu(bias, y):
[default3]:    x = bias + y
[default3]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default3]:                             ~~~~~~~~~~ <--- HERE
[default3]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 3; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.26 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default3]:
[default3]:
[default2]:Traceback (most recent call last):
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default2]:    pretrain(train_valid_test_datasets_provider,
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default2]:    set_jit_fusion_options()
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default2]:    _warmup_jit_function()
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default2]:    output = bias_gelu(bias, input)
[default2]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default2]:Traceback of TorchScript (most recent call last):
[default2]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default2]:Traceback of TorchScript (most recent call last):
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default2]:def bias_gelu(bias, y):
[default2]:    x = bias + y
[default2]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default2]:                             ~~~~~~~~~~ <--- HERE
[default2]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 2; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.21 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default2]:
[default2]:
[default1]:Traceback (most recent call last):
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default1]:    pretrain(train_valid_test_datasets_provider,
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default1]:    set_jit_fusion_options()
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default1]:    _warmup_jit_function()
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default1]:    output = bias_gelu(bias, input)
[default1]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default1]:Traceback of TorchScript (most recent call last):
[default1]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default1]:Traceback of TorchScript (most recent call last):
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default1]:def bias_gelu(bias, y):
[default1]:    x = bias + y
[default1]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default1]:                             ~~~~~~~~~~ <--- HERE
[default1]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 1; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.21 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default1]:
[default1]:
[default0]:Traceback (most recent call last):
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default0]:    pretrain(train_valid_test_datasets_provider,
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default0]:    set_jit_fusion_options()
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default0]:    _warmup_jit_function()
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default0]:    output = bias_gelu(bias, input)
[default0]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default0]:Traceback of TorchScript (most recent call last):
[default0]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default0]:Traceback of TorchScript (most recent call last):
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default0]:def bias_gelu(bias, y):
[default0]:    x = bias + y
[default0]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default0]:                             ~~~~~~~~~~ <--- HERE
[default0]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 0; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.26 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default0]:
[default0]:
[default2]:Traceback (most recent call last):
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default2]:    pretrain(train_valid_test_datasets_provider,
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default2]:    set_jit_fusion_options()
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default2]:    _warmup_jit_function()
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default2]:    output = bias_gelu(bias, input)
[default2]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default2]:Traceback of TorchScript (most recent call last):
[default2]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default2]:Traceback of TorchScript (most recent call last):
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default2]:def bias_gelu(bias, y):
[default2]:    x = bias + y
[default2]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default2]:                             ~~~~~~~~~~ <--- HERE
[default2]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 2; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.21 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default2]:
[default2]:
[default3]:Traceback (most recent call last):
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default3]:    pretrain(train_valid_test_datasets_provider,
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default3]:    set_jit_fusion_options()
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default3]:    _warmup_jit_function()
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default3]:    output = bias_gelu(bias, input)
[default3]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default3]:Traceback of TorchScript (most recent call last):
[default3]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default3]:Traceback of TorchScript (most recent call last):
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default3]:def bias_gelu(bias, y):
[default3]:    x = bias + y
[default3]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default3]:                             ~~~~~~~~~~ <--- HERE
[default3]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 3; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.26 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default3]:
[default3]:
[default0]:Traceback (most recent call last):
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default0]:    pretrain(train_valid_test_datasets_provider,
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default0]:    set_jit_fusion_options()
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default0]:    _warmup_jit_function()
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default0]:    output = bias_gelu(bias, input)
[default0]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default0]:Traceback of TorchScript (most recent call last):
[default0]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default0]:Traceback of TorchScript (most recent call last):
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default0]:def bias_gelu(bias, y):
[default0]:    x = bias + y
[default0]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default0]:                             ~~~~~~~~~~ <--- HERE
[default0]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 0; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.26 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default0]:
[default0]:
[default1]:Traceback (most recent call last):
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default1]:    pretrain(train_valid_test_datasets_provider,
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default1]:    set_jit_fusion_options()
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default1]:    _warmup_jit_function()
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default1]:    output = bias_gelu(bias, input)
[default1]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default1]:Traceback of TorchScript (most recent call last):
[default1]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default1]:Traceback of TorchScript (most recent call last):
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default1]:def bias_gelu(bias, y):
[default1]:    x = bias + y
[default1]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default1]:                             ~~~~~~~~~~ <--- HERE
[default1]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 1; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.21 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default1]:
[default1]:
[default2]:Traceback (most recent call last):
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py", line 342, in <module>
[default2]:    pretrain(train_valid_test_datasets_provider,
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default2]:    set_jit_fusion_options()
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default2]:    _warmup_jit_function()
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default2]:    output = bias_gelu(bias, input)
[default2]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default2]:Traceback of TorchScript (most recent call last):
[default2]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default2]:Traceback of TorchScript (most recent call last):
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default2]:def bias_gelu(bias, y):
[default2]:    x = bias + y
[default2]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default2]:                             ~~~~~~~~~~ <--- HERE
[default2]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 2; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.21 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default2]:
[default2]:
[default0]:    set_jit_fusion_options()
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default0]:    _warmup_jit_function()
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default0]:    output = bias_gelu(bias, input)
[default0]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default0]:Traceback of TorchScript (most recent call last):
[default0]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default0]:Traceback of TorchScript (most recent call last):
[default0]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default0]:def bias_gelu(bias, y):
[default0]:    x = bias + y
[default0]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default0]:                             ~~~~~~~~~~ <--- HERE
[default0]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 0; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.26 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default0]:
[default0]:
[default2]:    set_jit_fusion_options()
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default2]:    _warmup_jit_function()
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default2]:    output = bias_gelu(bias, input)
[default2]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default2]:Traceback of TorchScript (most recent call last):
[default2]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default2]:Traceback of TorchScript (most recent call last):
[default2]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default2]:def bias_gelu(bias, y):
[default2]:    x = bias + y
[default2]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default2]:                             ~~~~~~~~~~ <--- HERE
[default2]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 2; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.21 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default2]:
[default2]:
[default1]:    pretrain(train_valid_test_datasets_provider,
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/training.py", line 101, in pretrain
[default1]:    set_jit_fusion_options()
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default1]:    _warmup_jit_function()
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default1]:    output = bias_gelu(bias, input)
[default1]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default1]:Traceback of TorchScript (most recent call last):
[default1]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default1]:Traceback of TorchScript (most recent call last):
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default1]:def bias_gelu(bias, y):
[default1]:    x = bias + y
[default1]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default1]:                             ~~~~~~~~~~ <--- HERE
[default1]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 1; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.21 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default1]:
[default1]:
[default3]:    set_jit_fusion_options()
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 312, in set_jit_fusion_options
[default3]:    _warmup_jit_function()
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default3]:    output = bias_gelu(bias, input)
[default3]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default3]:Traceback of TorchScript (most recent call last):
[default3]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default3]:Traceback of TorchScript (most recent call last):
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default3]:def bias_gelu(bias, y):
[default3]:    x = bias + y
[default3]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default3]:                             ~~~~~~~~~~ <--- HERE
[default3]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 3; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.26 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default3]:
[default3]:
[default3]:    _warmup_jit_function()
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default3]:    output = bias_gelu(bias, input)
[default3]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default3]:Traceback of TorchScript (most recent call last):
[default3]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default3]:Traceback of TorchScript (most recent call last):
[default3]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default3]:def bias_gelu(bias, y):
[default3]:    x = bias + y
[default3]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default3]:                             ~~~~~~~~~~ <--- HERE
[default3]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 3; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.26 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default3]:
[default3]:
[default1]:    _warmup_jit_function()
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/initialize.py", line 336, in _warmup_jit_function
[default1]:    output = bias_gelu(bias, input)
[default1]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default1]:Traceback of TorchScript (most recent call last):
[default1]:RuntimeError: The following operation failed in the TorchScript interpreter.
[default1]:Traceback of TorchScript (most recent call last):
[default1]:  File "/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/megatron/model/fused_bias_gelu.py", line 17, in <forward op>
[default1]:def bias_gelu(bias, y):
[default1]:    x = bias + y
[default1]:    return  x * 0.5 * (1.0 + torch.tanh(0.79788456 * x * (1 + 0.044715 * x * x)))
[default1]:                             ~~~~~~~~~~ <--- HERE
[default1]:RuntimeError: CUDA out of memory. Tried to allocate 2.50 GiB (GPU 1; 39.39 GiB total capacity; 37.50 GiB already allocated; 1.21 GiB free; 37.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[default1]:
[default1]:
[default0]:n2gpu1222:1222636:1222816 [0] NCCL INFO [Service thread] Connection closed by localRank 0
[default2]:n2gpu1222:1222638:1222638 [2] NCCL INFO comm 0x14a6a40090d0 rank 6 nranks 16 cudaDev 2 busId 84000 - Abort COMPLETE
[default2]:n2gpu1223:1438922:1438922 [2] NCCL INFO comm 0x14c2bc0090d0 rank 10 nranks 16 cudaDev 2 busId 84000 - Abort COMPLETE
[default1]:n2gpu1207:436555:436555 [1] NCCL INFO comm 0x14feb40090d0 rank 1 nranks 16 cudaDev 1 busId 44000 - Abort COMPLETE
[default3]:n2gpu1207:436557:436557 [3] NCCL INFO comm 0x148b480090d0 rank 3 nranks 16 cudaDev 3 busId c4000 - Abort COMPLETE
[default2]:n2gpu1207:436556:436556 [2] NCCL INFO comm 0x1468a80090d0 rank 2 nranks 16 cudaDev 2 busId 84000 - Abort COMPLETE
[default2]:n2gpu1224:2602556:2602736 [2] NCCL INFO [Service thread] Connection closed by localRank 2
[default2]:n2gpu1224:2602556:2602556 [2] NCCL INFO comm 0x14fc980090d0 rank 14 nranks 16 cudaDev 2 busId 84000 - Abort COMPLETE
[default1]:n2gpu1224:2602555:2602555 [1] NCCL INFO comm 0x153ab80090d0 rank 13 nranks 16 cudaDev 1 busId 44000 - Abort COMPLETE
[default1]:n2gpu1222:1222637:1222637 [1] NCCL INFO comm 0x145ce00090d0 rank 5 nranks 16 cudaDev 1 busId 44000 - Abort COMPLETE
[default3]:n2gpu1222:1222639:1222817 [3] NCCL INFO [Service thread] Connection closed by localRank 3
[default3]:n2gpu1222:1222639:1222639 [3] NCCL INFO comm 0x14c06c0090d0 rank 7 nranks 16 cudaDev 3 busId c4000 - Abort COMPLETE
[default3]:n2gpu1223:1438923:1438923 [3] NCCL INFO comm 0x1518b80090d0 rank 11 nranks 16 cudaDev 3 busId c4000 - Abort COMPLETE
[default1]:n2gpu1223:1438921:1438921 [1] NCCL INFO comm 0x14a70c0090d0 rank 9 nranks 16 cudaDev 1 busId 44000 - Abort COMPLETE
[default3]:n2gpu1224:2602557:2602737 [3] NCCL INFO [Service thread] Connection closed by localRank 3
[default0]:n2gpu1207:436554:436554 [0] NCCL INFO comm 0x14aa880090d0 rank 0 nranks 16 cudaDev 0 busId 3000 - Abort COMPLETE
[default3]:n2gpu1224:2602557:2602557 [3] NCCL INFO comm 0x1454b40090d0 rank 15 nranks 16 cudaDev 3 busId c4000 - Abort COMPLETE
[default0]:n2gpu1224:2602554:2602554 [0] NCCL INFO comm 0x14af380090d0 rank 12 nranks 16 cudaDev 0 busId 3000 - Abort COMPLETE
[default0]:n2gpu1223:1438920:1438920 [0] NCCL INFO comm 0x14b3200090d0 rank 8 nranks 16 cudaDev 0 busId 3000 - Abort COMPLETE
[default0]:n2gpu1222:1222636:1222636 [0] NCCL INFO comm 0x14e5ec0090d0 rank 4 nranks 16 cudaDev 0 busId 3000 - Abort COMPLETE
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 436554) of binary: /scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/bin/python
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2602554) of binary: /scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/bin/python
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1222636) of binary: /scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/bin/python
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1438920) of binary: /scratch/hpc-prf-lola/lib_repo/custom-venvs/lola1/bin/python
Traceback (most recent call last):
  File "/opt/software/pc2/EB-SW/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/runpy.py", line 196, in _run_module_as_main
Traceback (most recent call last):
  File "/opt/software/pc2/EB-SW/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/opt/software/pc2/EB-SW/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/runpy.py", line 86, in _run_code
Traceback (most recent call last):
  File "/opt/software/pc2/EB-SW/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    exec(code, run_globals)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 765, in <module>
    return _run_code(code, main_globals, None,
  File "/opt/software/pc2/EB-SW/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 765, in <module>
    main()
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    main()
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 761, in main
    return f(*args, **kwargs)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 752, in run
    run(args)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    elastic_launch(
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
Traceback (most recent call last):
  File "/opt/software/pc2/EB-SW/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    return _run_code(code, main_globals, None,
  File "/opt/software/pc2/EB-SW/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/runpy.py", line 86, in _run_code
    return _run_code(code, main_globals, None,
  File "/opt/software/pc2/EB-SW/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 765, in <module>
    main()
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
    exec(code, run_globals)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 765, in <module>
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1223.ab2021.local
  rank      : 9 (local_rank: 1)
  exitcode  : 1 (pid: 1438921)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1223.ab2021.local
  rank      : 10 (local_rank: 2)
  exitcode  : 1 (pid: 1438922)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1223.ab2021.local
  rank      : 11 (local_rank: 3)
  exitcode  : 1 (pid: 1438923)
  error_file: <N/A>
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1222.ab2021.local
  rank      : 5 (local_rank: 1)
  exitcode  : 1 (pid: 1222637)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1222.ab2021.local
  rank      : 6 (local_rank: 2)
  exitcode  : 1 (pid: 1222638)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1222.ab2021.local
  rank      : 7 (local_rank: 3)
  exitcode  : 1 (pid: 1222639)
  error_file: <N/A>
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1207.ab2021.local
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 436555)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1207.ab2021.local
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 436556)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1207.ab2021.local
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 436557)
  error_file: <N/A>
    main()
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1223.ab2021.local
  rank      : 8 (local_rank: 0)
  exitcode  : 1 (pid: 1438920)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1222.ab2021.local
  rank      : 4 (local_rank: 0)
  exitcode  : 1 (pid: 1222636)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1207.ab2021.local
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 436554)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
    return f(*args, **kwargs)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/software/pc2/EB-SW/software/PyTorch/1.12.0-foss-2022a-CUDA-11.7.0/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-Microsoft/pretrain_gpt.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1224.ab2021.local
  rank      : 13 (local_rank: 1)
  exitcode  : 1 (pid: 2602555)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1224.ab2021.local
  rank      : 14 (local_rank: 2)
  exitcode  : 1 (pid: 2602556)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1224.ab2021.local
  rank      : 15 (local_rank: 3)
  exitcode  : 1 (pid: 2602557)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-07-31_05:17:18
  host      : n2gpu1224.ab2021.local
  rank      : 12 (local_rank: 0)
  exitcode  : 1 (pid: 2602554)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
srun: error: n2gpu1207: task 0: Exited with exit code 1
srun: launch/slurm: _step_signal: Terminating StepId=4505121.0
srun: error: n2gpu1223: task 2: Exited with exit code 1
srun: error: n2gpu1222: task 1: Exited with exit code 1
srun: error: n2gpu1224: task 3: Exited with exit code 1
